# ç¬¬ä¸€éƒ¨åˆ†ï¼šåˆ›å»ºå‹æ¨¡å¼

> åˆ›å»ºå‹æ¨¡å¼å…³æ³¨å¯¹è±¡çš„åˆ›å»ºæœºåˆ¶ï¼Œè®©ä½ çš„ä»£ç æ›´çµæ´»ã€æ›´æ˜“ç»´æŠ¤

## ç›®å½•
- [å•ä¾‹æ¨¡å¼ (Singleton)](#å•ä¾‹æ¨¡å¼)
- [å·¥å‚æ¨¡å¼ (Factory)](#å·¥å‚æ¨¡å¼)
- [ä¾èµ–æ³¨å…¥æ¨¡å¼ (Dependency Injection)](#ä¾èµ–æ³¨å…¥æ¨¡å¼)
- [å»ºé€ è€…æ¨¡å¼ (Builder)](#å»ºé€ è€…æ¨¡å¼)

---

## å•ä¾‹æ¨¡å¼

### ğŸ’¡ æ¨¡å¼å®šä¹‰
ç¡®ä¿ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›å…¨å±€è®¿é—®ç‚¹ã€‚

### ğŸ¤” ä¸ºä»€ä¹ˆéœ€è¦å•ä¾‹æ¨¡å¼ï¼Ÿ

#### é—®é¢˜åœºæ™¯ï¼šå…¨å±€çŠ¶æ€ç®¡ç†æ··ä¹±

å‡è®¾ä½ åœ¨å¼€å‘ä¸€ä¸ªç”µå•†åº”ç”¨ï¼Œéœ€è¦ç®¡ç†ç”¨æˆ·ç™»å½•çŠ¶æ€å’Œè´­ç‰©è½¦ï¼š

#### âŒ ä¸ä½¿ç”¨å•ä¾‹æ¨¡å¼çš„ç—›ç‚¹

```javascript
// UserManager.js - æ¯æ¬¡å¯¼å…¥éƒ½åˆ›å»ºæ–°å®ä¾‹
class UserManager {
  constructor() {
    this.currentUser = null;
    this.isLoggedIn = false;
  }

  login(user) {
    this.currentUser = user;
    this.isLoggedIn = true;
  }

  getUser() {
    return this.currentUser;
  }
}

export default UserManager;
```

```javascript
// Header.jsx - åˆ›å»ºäº†å®ä¾‹A
import UserManager from './UserManager';

function Header() {
  const userManager = new UserManager(); // å®ä¾‹A
  const user = userManager.getUser(); // nullï¼Œå› ä¸ºæ˜¯æ–°å®ä¾‹ï¼

  return <div>æ¬¢è¿, {user?.name || 'æ¸¸å®¢'}</div>;
}
```

```javascript
// LoginPage.jsx - åˆ›å»ºäº†å®ä¾‹B
import UserManager from './UserManager';

function LoginPage() {
  const userManager = new UserManager(); // å®ä¾‹B

  const handleLogin = () => {
    userManager.login({ name: 'å¼ ä¸‰', id: 1 });
    // å®ä¾‹Bä¿å­˜äº†ç”¨æˆ·ä¿¡æ¯ï¼Œä½†å®ä¾‹Aä¸çŸ¥é“ï¼
  };

  return <button onClick={handleLogin}>ç™»å½•</button>;
}
```

**é—®é¢˜**ï¼š
- æ¯ä¸ªç»„ä»¶åˆ›å»ºè‡ªå·±çš„ UserManager å®ä¾‹
- åœ¨ LoginPage ç™»å½•åï¼ŒHeader ä»ç„¶æ˜¾ç¤º"æ¸¸å®¢"
- çŠ¶æ€ä¸åŒæ­¥ï¼Œæ•°æ®å­¤å²›

---

#### âœ… ä½¿ç”¨å•ä¾‹æ¨¡å¼è§£å†³

```javascript
// UserManager.js - å•ä¾‹å®ç°
class UserManager {
  // ç§æœ‰é™æ€å®ä¾‹
  static instance = null;

  constructor() {
    // å¦‚æœå®ä¾‹å·²å­˜åœ¨ï¼Œè¿”å›å·²æœ‰å®ä¾‹
    if (UserManager.instance) {
      return UserManager.instance;
    }

    this.currentUser = null;
    this.isLoggedIn = false;

    // ä¿å­˜å®ä¾‹
    UserManager.instance = this;
  }

  login(user) {
    this.currentUser = user;
    this.isLoggedIn = true;
    console.log('ç”¨æˆ·å·²ç™»å½•:', user.name);
  }

  logout() {
    this.currentUser = null;
    this.isLoggedIn = false;
  }

  getUser() {
    return this.currentUser;
  }

  // é™æ€æ–¹æ³•è·å–å®ä¾‹
  static getInstance() {
    if (!UserManager.instance) {
      UserManager.instance = new UserManager();
    }
    return UserManager.instance;
  }
}

// å¯¼å‡ºå•ä¾‹å®ä¾‹
export default UserManager.getInstance();
```

```javascript
// Header.jsx - ä½¿ç”¨å•ä¾‹
import userManager from './UserManager';

function Header() {
  const [user, setUser] = React.useState(userManager.getUser());

  React.useEffect(() => {
    // ç›‘å¬ç”¨æˆ·çŠ¶æ€å˜åŒ–
    const interval = setInterval(() => {
      setUser(userManager.getUser());
    }, 1000);
    return () => clearInterval(interval);
  }, []);

  return <div>æ¬¢è¿, {user?.name || 'æ¸¸å®¢'}</div>;
}
```

```javascript
// LoginPage.jsx - ä½¿ç”¨åŒä¸€ä¸ªå•ä¾‹
import userManager from './UserManager';

function LoginPage() {
  const handleLogin = () => {
    userManager.login({ name: 'å¼ ä¸‰', id: 1 });
    // Header ä¼šç«‹å³æ„ŸçŸ¥åˆ°ç”¨æˆ·ç™»å½•ï¼
  };

  return <button onClick={handleLogin}>ç™»å½•</button>;
}
```

**æ•ˆæœ**ï¼š
- âœ… å…¨å±€åªæœ‰ä¸€ä¸ª UserManager å®ä¾‹
- âœ… æ‰€æœ‰ç»„ä»¶å…±äº«åŒä¸€ä¸ªçŠ¶æ€
- âœ… ç™»å½•åæ‰€æœ‰ç»„ä»¶ç«‹å³åŒæ­¥

---

### ğŸ¯ æ›´ä¼˜é›…çš„å•ä¾‹å®ç°æ–¹å¼

#### æ–¹å¼1ï¼šES6 æ¨¡å—å¤©ç„¶å•ä¾‹

```javascript
// userStore.js - åˆ©ç”¨ES6æ¨¡å—ç‰¹æ€§
class UserStore {
  constructor() {
    this.currentUser = null;
    this.listeners = [];
  }

  login(user) {
    this.currentUser = user;
    this.notify();
  }

  subscribe(listener) {
    this.listeners.push(listener);
    return () => {
      this.listeners = this.listeners.filter(l => l !== listener);
    };
  }

  notify() {
    this.listeners.forEach(listener => listener(this.currentUser));
  }
}

// ç›´æ¥å¯¼å‡ºå®ä¾‹ - ES6 æ¨¡å—åªä¼šæ‰§è¡Œä¸€æ¬¡
export default new UserStore();
```

```javascript
// åœ¨Reactä¸­ä½¿ç”¨
import userStore from './userStore';

function Header() {
  const [user, setUser] = React.useState(null);

  React.useEffect(() => {
    return userStore.subscribe(setUser);
  }, []);

  return <div>æ¬¢è¿, {user?.name || 'æ¸¸å®¢'}</div>;
}
```

#### æ–¹å¼2ï¼šä½¿ç”¨é—­åŒ…å®ç°å•ä¾‹

```javascript
// configManager.js
const ConfigManager = (function() {
  let instance;
  let config = {};

  function init() {
    return {
      set(key, value) {
        config[key] = value;
      },
      get(key) {
        return config[key];
      },
      getAll() {
        return { ...config };
      }
    };
  }

  return {
    getInstance() {
      if (!instance) {
        instance = init();
      }
      return instance;
    }
  };
})();

export default ConfigManager.getInstance();
```

---

### ğŸ—ï¸ çœŸå®ä¸šåŠ¡åœºæ™¯

#### åœºæ™¯1ï¼šAxios å®ä¾‹ç®¡ç†

```javascript
// api/request.js - HTTP å®¢æˆ·ç«¯å•ä¾‹
import axios from 'axios';

class ApiClient {
  constructor() {
    if (ApiClient.instance) {
      return ApiClient.instance;
    }

    this.client = axios.create({
      baseURL: process.env.REACT_APP_API_URL,
      timeout: 10000,
    });

    // è¯·æ±‚æ‹¦æˆªå™¨
    this.client.interceptors.request.use(config => {
      const token = localStorage.getItem('token');
      if (token) {
        config.headers.Authorization = `Bearer ${token}`;
      }
      return config;
    });

    // å“åº”æ‹¦æˆªå™¨
    this.client.interceptors.response.use(
      response => response.data,
      error => {
        if (error.response?.status === 401) {
          // å…¨å±€å¤„ç†æœªæˆæƒ
          window.location.href = '/login';
        }
        return Promise.reject(error);
      }
    );

    ApiClient.instance = this;
  }

  get(url, config) {
    return this.client.get(url, config);
  }

  post(url, data, config) {
    return this.client.post(url, data, config);
  }
}

export default new ApiClient();
```

```javascript
// åœ¨ç»„ä»¶ä¸­ä½¿ç”¨
import apiClient from './api/request';

function ProductList() {
  const [products, setProducts] = React.useState([]);

  React.useEffect(() => {
    apiClient.get('/products').then(setProducts);
  }, []);

  return <div>{products.map(p => <div key={p.id}>{p.name}</div>)}</div>;
}
```

#### åœºæ™¯2ï¼šæ—¥å¿—ç®¡ç†å™¨

```javascript
// logger.js
class Logger {
  constructor() {
    if (Logger.instance) {
      return Logger.instance;
    }

    this.logs = [];
    this.maxLogs = 1000;
    Logger.instance = this;
  }

  log(level, message, data) {
    const logEntry = {
      timestamp: new Date().toISOString(),
      level,
      message,
      data,
    };

    this.logs.push(logEntry);

    // é™åˆ¶æ—¥å¿—æ•°é‡
    if (this.logs.length > this.maxLogs) {
      this.logs.shift();
    }

    // å¼€å‘ç¯å¢ƒæ‰“å°åˆ°æ§åˆ¶å°
    if (process.env.NODE_ENV === 'development') {
      console[level](message, data);
    }

    // ç”Ÿäº§ç¯å¢ƒå‘é€åˆ°æœåŠ¡å™¨
    if (process.env.NODE_ENV === 'production' && level === 'error') {
      this.sendToServer(logEntry);
    }
  }

  error(message, data) {
    this.log('error', message, data);
  }

  info(message, data) {
    this.log('info', message, data);
  }

  sendToServer(logEntry) {
    // å‘é€åˆ°æ—¥å¿—æœåŠ¡å™¨
    fetch('/api/logs', {
      method: 'POST',
      body: JSON.stringify(logEntry),
    });
  }

  getLogs() {
    return [...this.logs];
  }
}

export default new Logger();
```

---

### ğŸ¨ åœ¨ä¸»æµæ¡†æ¶ä¸­çš„åº”ç”¨

#### Redux Store - å•ä¾‹æ¨¡å¼å…¸èŒƒ

```javascript
// store.js
import { createStore } from 'redux';
import rootReducer from './reducers';

// Redux Store æ˜¯å•ä¾‹
const store = createStore(rootReducer);

export default store;
```

```javascript
// App.jsx
import { Provider } from 'react-redux';
import store from './store';

function App() {
  return (
    <Provider store={store}> {/* å…¨å±€å…±äº«åŒä¸€ä¸ª store */}
      <YourApp />
    </Provider>
  );
}
```

#### Vue Router - å•ä¾‹å®ä¾‹

```javascript
// router.js
import Vue from 'vue';
import VueRouter from 'vue-router';

Vue.use(VueRouter);

// åˆ›å»ºå•ä¾‹è·¯ç”±å®ä¾‹
const router = new VueRouter({
  routes: [
    { path: '/', component: Home },
    { path: '/about', component: About },
  ]
});

export default router;
```

---

### âš–ï¸ ä¼˜ç¼ºç‚¹åˆ†æ

#### âœ… ä¼˜ç‚¹

1. **å”¯ä¸€å®ä¾‹**ï¼šç¡®ä¿å…¨å±€åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼ŒèŠ‚çœå†…å­˜
2. **å…¨å±€è®¿é—®**ï¼šæä¾›å…¨å±€è®¿é—®ç‚¹ï¼Œæ–¹ä¾¿è°ƒç”¨
3. **å»¶è¿Ÿåˆå§‹åŒ–**ï¼šå¯ä»¥åœ¨é¦–æ¬¡ä½¿ç”¨æ—¶æ‰åˆ›å»ºå®ä¾‹
4. **çŠ¶æ€å…±äº«**ï¼šå¤šä¸ªæ¨¡å—å…±äº«åŒä¸€çŠ¶æ€

#### âŒ ç¼ºç‚¹

1. **å…¨å±€æ±¡æŸ“**ï¼šç›¸å½“äºå…¨å±€å˜é‡ï¼Œå¯èƒ½å¯¼è‡´å‘½åå†²çª
2. **éš¾ä»¥æµ‹è¯•**ï¼šå•ä¾‹åœ¨æµ‹è¯•ä¸­éš¾ä»¥ mock
3. **éšè—ä¾èµ–**ï¼šä»£ç ä¾èµ–å…³ç³»ä¸æ˜æ˜¾
4. **è¿åå•ä¸€èŒè´£**ï¼šç±»æ—¢ç®¡ç†è‡ªå·±çš„èŒè´£ï¼Œåˆç®¡ç†å®ä¾‹åˆ›å»º

---

### ğŸ“‹ ä½•æ—¶ä½¿ç”¨å•ä¾‹æ¨¡å¼

#### âœ… é€‚åˆä½¿ç”¨çš„åœºæ™¯

- å…¨å±€é…ç½®ç®¡ç†ï¼ˆConfigï¼‰
- æ—¥å¿—ç®¡ç†å™¨ï¼ˆLoggerï¼‰
- ç¼“å­˜ç®¡ç†ï¼ˆCacheï¼‰
- HTTP å®¢æˆ·ç«¯ï¼ˆAxios å®ä¾‹ï¼‰
- çŠ¶æ€ç®¡ç†å™¨ï¼ˆRedux Store, Vuex Storeï¼‰
- æ•°æ®åº“è¿æ¥æ± 
- è·¯ç”±å®ä¾‹

#### âŒ ä¸é€‚åˆä½¿ç”¨çš„åœºæ™¯

- éœ€è¦åˆ›å»ºå¤šä¸ªå®ä¾‹çš„å¯¹è±¡
- éœ€è¦é¢‘ç¹åˆ›å»ºå’Œé”€æ¯çš„å¯¹è±¡
- æœ‰å¤æ‚ç»§æ‰¿å…³ç³»çš„ç±»
- éœ€è¦åœ¨ä¸åŒä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨ä¸åŒé…ç½®çš„å¯¹è±¡

---

### ğŸ“ å•ä¾‹æ¨¡å¼ vs React Context

åœ¨ React ä¸­ï¼Œæˆ‘ä»¬æ›´æ¨èä½¿ç”¨ Context è€Œä¸æ˜¯ä¼ ç»Ÿå•ä¾‹ï¼š

```javascript
// ä½¿ç”¨ Context æ›¿ä»£å•ä¾‹
import React from 'react';

const UserContext = React.createContext(null);

export function UserProvider({ children }) {
  const [user, setUser] = React.useState(null);

  const login = (userData) => {
    setUser(userData);
  };

  const logout = () => {
    setUser(null);
  };

  return (
    <UserContext.Provider value={{ user, login, logout }}>
      {children}
    </UserContext.Provider>
  );
}

export const useUser = () => React.useContext(UserContext);
```

```javascript
// ä½¿ç”¨
function Header() {
  const { user, logout } = useUser();
  return <div>{user?.name} <button onClick={logout}>é€€å‡º</button></div>;
}
```

**Context çš„ä¼˜åŠ¿**ï¼š
- âœ… æ›´ç¬¦åˆ React æ•°æ®æµ
- âœ… è‡ªåŠ¨è§¦å‘ç»„ä»¶é‡æ¸²æŸ“
- âœ… æ›´æ˜“äºæµ‹è¯•ï¼ˆå¯ä»¥åŒ…è£¹è‡ªå®šä¹‰ Providerï¼‰
- âœ… æ”¯æŒå¤šä¸ªä¸Šä¸‹æ–‡å¹¶å­˜

---

## å·¥å‚æ¨¡å¼

### ğŸ’¡ æ¨¡å¼å®šä¹‰
å®šä¹‰ä¸€ä¸ªåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè®©å­ç±»å†³å®šå®ä¾‹åŒ–å“ªä¸ªç±»ã€‚å·¥å‚æ¨¡å¼å°†å¯¹è±¡çš„åˆ›å»ºå»¶è¿Ÿåˆ°å­ç±»ã€‚

### ğŸ¤” ä¸ºä»€ä¹ˆéœ€è¦å·¥å‚æ¨¡å¼?

#### é—®é¢˜åœºæ™¯ï¼šæ ¹æ®ç±»å‹åˆ›å»ºä¸åŒç»„ä»¶

å‡è®¾ä½ åœ¨å¼€å‘ä¸€ä¸ªè¡¨å•ç”Ÿæˆå™¨ï¼Œéœ€è¦æ ¹æ®é…ç½®åŠ¨æ€ç”Ÿæˆä¸åŒç±»å‹çš„è¡¨å•é¡¹ï¼š

#### âŒ ä¸ä½¿ç”¨å·¥å‚æ¨¡å¼çš„ç—›ç‚¹

```javascript
// FormItem.jsx - å……æ»¡ if-else çš„ç»„ä»¶
function FormItem({ type, config }) {
  // å¤§é‡ if-else åˆ¤æ–­
  if (type === 'text') {
    return <input type="text" {...config} />;
  } else if (type === 'number') {
    return <input type="number" {...config} />;
  } else if (type === 'select') {
    return (
      <select {...config}>
        {config.options.map(opt => (
          <option key={opt.value} value={opt.value}>{opt.label}</option>
        ))}
      </select>
    );
  } else if (type === 'date') {
    return <input type="date" {...config} />;
  } else if (type === 'textarea') {
    return <textarea {...config} />;
  } else if (type === 'checkbox') {
    return <input type="checkbox" {...config} />;
  } else if (type === 'radio') {
    return (
      <div>
        {config.options.map(opt => (
          <label key={opt.value}>
            <input type="radio" value={opt.value} {...config} />
            {opt.label}
          </label>
        ))}
      </div>
    );
  } else if (type === 'file') {
    return <input type="file" {...config} />;
  }

  return null;
}
```

**é—®é¢˜**ï¼š
- ä»£ç è‡ƒè‚¿ï¼Œéš¾ä»¥ç»´æŠ¤
- æ–°å¢ç±»å‹éœ€è¦ä¿®æ”¹ä¸»ç»„ä»¶ï¼ˆè¿åå¼€é—­åŸåˆ™ï¼‰
- æ¯ç§ç±»å‹çš„é€»è¾‘è€¦åˆåœ¨ä¸€èµ·
- æ— æ³•ç‹¬ç«‹æµ‹è¯•æ¯ç§ç±»å‹

---

#### âœ… ä½¿ç”¨å·¥å‚æ¨¡å¼è§£å†³

```javascript
// formComponents/TextInput.jsx
export function TextInput({ value, onChange, placeholder }) {
  return (
    <input
      type="text"
      value={value}
      onChange={onChange}
      placeholder={placeholder}
    />
  );
}

// formComponents/SelectInput.jsx
export function SelectInput({ value, onChange, options }) {
  return (
    <select value={value} onChange={onChange}>
      <option value="">è¯·é€‰æ‹©</option>
      {options.map(opt => (
        <option key={opt.value} value={opt.value}>
          {opt.label}
        </option>
      ))}
    </select>
  );
}

// formComponents/DateInput.jsx
export function DateInput({ value, onChange }) {
  return <input type="date" value={value} onChange={onChange} />;
}

// ... å…¶ä»–ç»„ä»¶ç±»ä¼¼
```

```javascript
// FormComponentFactory.js - å·¥å‚ç±»
import { TextInput } from './formComponents/TextInput';
import { SelectInput } from './formComponents/SelectInput';
import { DateInput } from './formComponents/DateInput';
import { TextareaInput } from './formComponents/TextareaInput';
import { CheckboxInput } from './formComponents/CheckboxInput';
import { RadioInput } from './formComponents/RadioInput';

class FormComponentFactory {
  constructor() {
    // æ³¨å†Œæ‰€æœ‰è¡¨å•ç»„ä»¶
    this.components = {
      text: TextInput,
      select: SelectInput,
      date: DateInput,
      textarea: TextareaInput,
      checkbox: CheckboxInput,
      radio: RadioInput,
    };
  }

  // åˆ›å»ºç»„ä»¶
  create(type) {
    const Component = this.components[type];

    if (!Component) {
      console.warn(`Unknown form component type: ${type}`);
      return null;
    }

    return Component;
  }

  // æ³¨å†Œæ–°ç»„ä»¶ï¼ˆæ”¯æŒæ‰©å±•ï¼‰
  register(type, Component) {
    this.components[type] = Component;
  }

  // æ‰¹é‡æ³¨å†Œ
  registerMultiple(componentsMap) {
    Object.assign(this.components, componentsMap);
  }
}

export default new FormComponentFactory();
```

```javascript
// FormItem.jsx - ç®€æ´çš„ç»„ä»¶
import React from 'react';
import formFactory from './FormComponentFactory';

function FormItem({ type, value, onChange, ...config }) {
  const Component = formFactory.create(type);

  if (!Component) {
    return <div>ä¸æ”¯æŒçš„è¡¨å•ç±»å‹: {type}</div>;
  }

  return (
    <div className="form-item">
      <label>{config.label}</label>
      <Component value={value} onChange={onChange} {...config} />
    </div>
  );
}

export default FormItem;
```

```javascript
// ä½¿ç”¨ç¤ºä¾‹
function UserForm() {
  const [formData, setFormData] = React.useState({
    name: '',
    age: '',
    gender: '',
    birthday: '',
  });

  const formConfig = [
    { type: 'text', name: 'name', label: 'å§“å' },
    { type: 'number', name: 'age', label: 'å¹´é¾„' },
    {
      type: 'select',
      name: 'gender',
      label: 'æ€§åˆ«',
      options: [
        { value: 'male', label: 'ç”·' },
        { value: 'female', label: 'å¥³' },
      ]
    },
    { type: 'date', name: 'birthday', label: 'ç”Ÿæ—¥' },
  ];

  const handleChange = (name, value) => {
    setFormData(prev => ({ ...prev, [name]: value }));
  };

  return (
    <form>
      {formConfig.map(config => (
        <FormItem
          key={config.name}
          {...config}
          value={formData[config.name]}
          onChange={(e) => handleChange(config.name, e.target.value)}
        />
      ))}
    </form>
  );
}
```

**æ•ˆæœ**ï¼š
- âœ… æ¯ç§è¡¨å•ç»„ä»¶ç‹¬ç«‹ç»´æŠ¤
- âœ… æ–°å¢ç±»å‹åªéœ€æ³¨å†Œï¼Œä¸ä¿®æ”¹æ ¸å¿ƒä»£ç 
- âœ… ä»£ç æ¸…æ™°ï¼Œæ˜“äºæµ‹è¯•
- âœ… æ”¯æŒåŠ¨æ€æ‰©å±•

---

### ğŸ¯ é«˜çº§ï¼šæŠ½è±¡å·¥å‚æ¨¡å¼

å½“ä½ éœ€è¦åˆ›å»ºä¸€ç³»åˆ—ç›¸å…³å¯¹è±¡æ—¶ï¼š

```javascript
// ä¸åŒä¸»é¢˜çš„æŒ‰é’®å·¥å‚
class LightThemeFactory {
  createButton() {
    return function Button({ children, onClick }) {
      return (
        <button
          onClick={onClick}
          style={{
            background: '#fff',
            color: '#333',
            border: '1px solid #ddd',
          }}
        >
          {children}
        </button>
      );
    };
  }

  createInput() {
    return function Input(props) {
      return (
        <input
          {...props}
          style={{
            background: '#fff',
            color: '#333',
            border: '1px solid #ddd',
          }}
        />
      );
    };
  }
}

class DarkThemeFactory {
  createButton() {
    return function Button({ children, onClick }) {
      return (
        <button
          onClick={onClick}
          style={{
            background: '#333',
            color: '#fff',
            border: '1px solid #555',
          }}
        >
          {children}
        </button>
      );
    };
  }

  createInput() {
    return function Input(props) {
      return (
        <input
          {...props}
          style={{
            background: '#333',
            color: '#fff',
            border: '1px solid #555',
          }}
        />
      );
    };
  }
}

// ä½¿ç”¨
function App() {
  const [theme, setTheme] = React.useState('light');

  // æ ¹æ®ä¸»é¢˜é€‰æ‹©å·¥å‚
  const factory = theme === 'light'
    ? new LightThemeFactory()
    : new DarkThemeFactory();

  const Button = factory.createButton();
  const Input = factory.createInput();

  return (
    <div>
      <Button onClick={() => setTheme(theme === 'light' ? 'dark' : 'light')}>
        åˆ‡æ¢ä¸»é¢˜
      </Button>
      <Input placeholder="è¾“å…¥å†…å®¹" />
    </div>
  );
}
```

---

### ğŸ—ï¸ çœŸå®ä¸šåŠ¡åœºæ™¯

#### åœºæ™¯1ï¼šé€šçŸ¥ç»„ä»¶å·¥å‚

```javascript
// notifications/SuccessNotification.jsx
export function SuccessNotification({ message, onClose }) {
  return (
    <div style={{ background: '#52c41a', color: '#fff', padding: '12px' }}>
      âœ“ {message}
      <button onClick={onClose}>Ã—</button>
    </div>
  );
}

// notifications/ErrorNotification.jsx
export function ErrorNotification({ message, onClose }) {
  return (
    <div style={{ background: '#ff4d4f', color: '#fff', padding: '12px' }}>
      âœ• {message}
      <button onClick={onClose}>Ã—</button>
    </div>
  );
}

// notifications/WarningNotification.jsx
export function WarningNotification({ message, onClose }) {
  return (
    <div style={{ background: '#faad14', color: '#fff', padding: '12px' }}>
      âš  {message}
      <button onClick={onClose}>Ã—</button>
    </div>
  );
}
```

```javascript
// NotificationFactory.js
import { SuccessNotification } from './notifications/SuccessNotification';
import { ErrorNotification } from './notifications/ErrorNotification';
import { WarningNotification } from './notifications/WarningNotification';

class NotificationFactory {
  constructor() {
    this.types = {
      success: SuccessNotification,
      error: ErrorNotification,
      warning: WarningNotification,
    };
  }

  create(type, props) {
    const Component = this.types[type];
    if (!Component) return null;
    return <Component {...props} />;
  }
}

export default new NotificationFactory();
```

```javascript
// useNotification hook
import React from 'react';
import notificationFactory from './NotificationFactory';

export function useNotification() {
  const [notifications, setNotifications] = React.useState([]);

  const show = (type, message, duration = 3000) => {
    const id = Date.now();
    const notification = {
      id,
      type,
      message,
    };

    setNotifications(prev => [...prev, notification]);

    // è‡ªåŠ¨å…³é—­
    if (duration > 0) {
      setTimeout(() => {
        setNotifications(prev => prev.filter(n => n.id !== id));
      }, duration);
    }
  };

  const close = (id) => {
    setNotifications(prev => prev.filter(n => n.id !== id));
  };

  const NotificationContainer = () => (
    <div style={{ position: 'fixed', top: 20, right: 20, zIndex: 9999 }}>
      {notifications.map(n => (
        <div key={n.id} style={{ marginBottom: 10 }}>
          {notificationFactory.create(n.type, {
            message: n.message,
            onClose: () => close(n.id),
          })}
        </div>
      ))}
    </div>
  );

  return {
    success: (msg) => show('success', msg),
    error: (msg) => show('error', msg),
    warning: (msg) => show('warning', msg),
    NotificationContainer,
  };
}
```

```javascript
// ä½¿ç”¨
function App() {
  const notification = useNotification();

  return (
    <div>
      <button onClick={() => notification.success('ä¿å­˜æˆåŠŸï¼')}>
        æµ‹è¯•æˆåŠŸé€šçŸ¥
      </button>
      <button onClick={() => notification.error('ä¿å­˜å¤±è´¥ï¼')}>
        æµ‹è¯•é”™è¯¯é€šçŸ¥
      </button>
      <button onClick={() => notification.warning('è¯·æ³¨æ„ï¼')}>
        æµ‹è¯•è­¦å‘Šé€šçŸ¥
      </button>

      <notification.NotificationContainer />
    </div>
  );
}
```

#### åœºæ™¯2ï¼šå›¾è¡¨ç»„ä»¶å·¥å‚

```javascript
// ChartFactory.js
import { LineChart } from './charts/LineChart';
import { BarChart } from './charts/BarChart';
import { PieChart } from './charts/PieChart';

class ChartFactory {
  static create(type, data, options) {
    switch(type) {
      case 'line':
        return <LineChart data={data} options={options} />;
      case 'bar':
        return <BarChart data={data} options={options} />;
      case 'pie':
        return <PieChart data={data} options={options} />;
      default:
        return <div>ä¸æ”¯æŒçš„å›¾è¡¨ç±»å‹</div>;
    }
  }
}

export default ChartFactory;
```

```javascript
// Dashboard.jsx
function Dashboard() {
  const chartsConfig = [
    { type: 'line', data: salesData, title: 'é”€å”®è¶‹åŠ¿' },
    { type: 'bar', data: userGrowth, title: 'ç”¨æˆ·å¢é•¿' },
    { type: 'pie', data: marketShare, title: 'å¸‚åœºä»½é¢' },
  ];

  return (
    <div className="dashboard">
      {chartsConfig.map((config, index) => (
        <div key={index} className="chart-container">
          <h3>{config.title}</h3>
          {ChartFactory.create(config.type, config.data)}
        </div>
      ))}
    </div>
  );
}
```

---

### ğŸ¨ åœ¨ä¸»æµæ¡†æ¶ä¸­çš„åº”ç”¨

#### React.createElement - å·¥å‚æ¨¡å¼æ ¸å¿ƒ

```javascript
// React å†…éƒ¨ä½¿ç”¨å·¥å‚æ¨¡å¼åˆ›å»ºå…ƒç´ 
React.createElement('div', { className: 'box' }, 'Hello');

// JSX æœ¬è´¨ä¸Šå°±æ˜¯å·¥å‚æ¨¡å¼
<div className="box">Hello</div>
// â†“ ç¼–è¯‘å
React.createElement('div', { className: 'box' }, 'Hello');
```

#### Vue 3 h å‡½æ•°

```javascript
import { h } from 'vue';

// h å‡½æ•°æ˜¯å·¥å‚å‡½æ•°
export default {
  render() {
    return h('div', { class: 'box' }, 'Hello');
  }
}
```

---

### âš–ï¸ ä¼˜ç¼ºç‚¹åˆ†æ

#### âœ… ä¼˜ç‚¹

1. **è§£è€¦**ï¼šå¯¹è±¡åˆ›å»ºå’Œä½¿ç”¨åˆ†ç¦»
2. **æ‰©å±•æ€§**ï¼šæ–°å¢ç±»å‹ä¸éœ€è¦ä¿®æ”¹ç°æœ‰ä»£ç 
3. **ç»Ÿä¸€ç®¡ç†**ï¼šé›†ä¸­ç®¡ç†å¯¹è±¡åˆ›å»ºé€»è¾‘
4. **æ˜“äºæµ‹è¯•**ï¼šå¯ä»¥ mock å·¥å‚è¿”å›æµ‹è¯•å¯¹è±¡

#### âŒ ç¼ºç‚¹

1. **å¢åŠ å¤æ‚åº¦**ï¼šå¼•å…¥é¢å¤–çš„å·¥å‚ç±»
2. **ç±»è†¨èƒ€**ï¼šæ¯ä¸ªç±»å‹éƒ½éœ€è¦ä¸€ä¸ªç±»/ç»„ä»¶
3. **é—´æ¥æ€§**ï¼šå¢åŠ äº†ä»£ç çš„é—´æ¥å±‚æ¬¡

---

### ğŸ“‹ ä½•æ—¶ä½¿ç”¨å·¥å‚æ¨¡å¼

#### âœ… é€‚åˆä½¿ç”¨çš„åœºæ™¯

- åŠ¨æ€è¡¨å•ç”Ÿæˆ
- æ ¹æ®é…ç½®åˆ›å»ºä¸åŒç»„ä»¶
- é€šçŸ¥/æ¶ˆæ¯ç»„ä»¶
- å›¾è¡¨åº“
- è·¯ç”±é…ç½®è½¬ç»„ä»¶
- æ’ä»¶ç³»ç»Ÿ

#### âŒ ä¸é€‚åˆä½¿ç”¨çš„åœºæ™¯

- åªæœ‰ 1-2 ç§ç±»å‹çš„æƒ…å†µ
- ç±»å‹å›ºå®šä¸ä¼šæ‰©å±•
- åˆ›å»ºé€»è¾‘éå¸¸ç®€å•
- ç›´æ¥åˆ›å»ºæ›´æ¸…æ™°çš„åœºæ™¯

---

## ä¾èµ–æ³¨å…¥æ¨¡å¼

### ğŸ’¡ æ¨¡å¼å®šä¹‰
ä¾èµ–æ³¨å…¥ï¼ˆDependency Injection, DIï¼‰æ˜¯ä¸€ç§å®ç°æ§åˆ¶åè½¬ï¼ˆIoCï¼‰çš„è®¾è®¡æ¨¡å¼ã€‚å®ƒå°†å¯¹è±¡çš„ä¾èµ–å…³ç³»ä»å¯¹è±¡å†…éƒ¨è½¬ç§»åˆ°å¤–éƒ¨å®¹å™¨ï¼Œç”±å¤–éƒ¨è´Ÿè´£åˆ›å»ºå’Œæ³¨å…¥ä¾èµ–ã€‚

### ğŸ¤” æ§åˆ¶åè½¬ vs ä¾èµ–æ³¨å…¥

```
æ§åˆ¶åè½¬ï¼ˆIoC - Inversion of Controlï¼‰
  â†“ è¿™æ˜¯ä¸€ç§è®¾è®¡åŸåˆ™/æ€æƒ³
  "ä¸è¦è‡ªå·±åˆ›å»ºä¾èµ–ï¼Œè®©åˆ«äººç»™ä½ "
  â†“ å…·ä½“å®ç°æ–¹å¼ä¹‹ä¸€
ä¾èµ–æ³¨å…¥ï¼ˆDI - Dependency Injectionï¼‰
  â†“ è¿™æ˜¯ä¸€ç§å…·ä½“çš„è®¾è®¡æ¨¡å¼
  "é€šè¿‡æ„é€ å‡½æ•°ã€æ–¹æ³•ã€å±æ€§æ³¨å…¥ä¾èµ–"
```

### ğŸ¤” ä¸ºä»€ä¹ˆéœ€è¦ä¾èµ–æ³¨å…¥ï¼Ÿ

#### é—®é¢˜åœºæ™¯ï¼šç»„ä»¶ä¾èµ–éš¾ä»¥æµ‹è¯•å’Œå¤ç”¨

#### âŒ ä¸ä½¿ç”¨ä¾èµ–æ³¨å…¥çš„ç—›ç‚¹

```javascript
// UserService.js - ç¡¬ç¼–ç ä¾èµ–
class UserService {
  constructor() {
    // ç›´æ¥åœ¨å†…éƒ¨åˆ›å»ºä¾èµ–ï¼ˆç¡¬ç¼–ç ï¼‰
    this.apiClient = axios.create({
      baseURL: 'https://api.example.com',
      timeout: 5000,
    });

    this.logger = console; // ç›´æ¥ä¾èµ– console
    this.cache = new Map(); // ç›´æ¥åˆ›å»ºç¼“å­˜
  }

  async getUser(id) {
    // æ£€æŸ¥ç¼“å­˜
    if (this.cache.has(id)) {
      this.logger.log('ä»ç¼“å­˜è·å–ç”¨æˆ·:', id);
      return this.cache.get(id);
    }

    // è¯·æ±‚ API
    try {
      this.logger.log('ä» API è·å–ç”¨æˆ·:', id);
      const response = await this.apiClient.get(`/users/${id}`);
      this.cache.set(id, response.data);
      return response.data;
    } catch (error) {
      this.logger.error('è·å–ç”¨æˆ·å¤±è´¥:', error);
      throw error;
    }
  }
}

export default new UserService();
```

```javascript
// UserProfile.jsx - éš¾ä»¥æµ‹è¯•çš„ç»„ä»¶
import userService from './UserService';

function UserProfile({ userId }) {
  const [user, setUser] = React.useState(null);

  React.useEffect(() => {
    // ç›´æ¥ä¾èµ–å…¨å±€çš„ userService
    userService.getUser(userId).then(setUser);
  }, [userId]);

  return user ? <div>{user.name}</div> : <div>åŠ è½½ä¸­...</div>;
}
```

**é—®é¢˜**ï¼š
- âŒ **éš¾ä»¥æµ‹è¯•**ï¼šæ— æ³• mock apiClientã€loggerã€cache
- âŒ **éš¾ä»¥å¤ç”¨**ï¼šåœ¨ä¸åŒç¯å¢ƒï¼ˆå¼€å‘/æµ‹è¯•/ç”Ÿäº§ï¼‰ä½¿ç”¨ä¸åŒé…ç½®å¾ˆå›°éš¾
- âŒ **è€¦åˆåº¦é«˜**ï¼šUserService å¿…é¡»ä½¿ç”¨ç‰¹å®šçš„ä¾èµ–
- âŒ **ä¸çµæ´»**ï¼šæ›´æ¢ä¾èµ–éœ€è¦ä¿®æ”¹ UserService æºç 

---

#### âœ… ä½¿ç”¨ä¾èµ–æ³¨å…¥è§£å†³

```javascript
// UserService.js - ä¾èµ–é€šè¿‡æ„é€ å‡½æ•°æ³¨å…¥
class UserService {
  constructor(apiClient, logger, cache) {
    // ä¾èµ–ä»å¤–éƒ¨æ³¨å…¥
    this.apiClient = apiClient;
    this.logger = logger;
    this.cache = cache;
  }

  async getUser(id) {
    if (this.cache.has(id)) {
      this.logger.log('ä»ç¼“å­˜è·å–ç”¨æˆ·:', id);
      return this.cache.get(id);
    }

    try {
      this.logger.log('ä» API è·å–ç”¨æˆ·:', id);
      const response = await this.apiClient.get(`/users/${id}`);
      this.cache.set(id, response.data);
      return response.data;
    } catch (error) {
      this.logger.error('è·å–ç”¨æˆ·å¤±è´¥:', error);
      throw error;
    }
  }
}

export default UserService;
```

```javascript
// di-container.js - DI å®¹å™¨
import axios from 'axios';
import UserService from './UserService';
import Logger from './Logger';

class DIContainer {
  constructor() {
    this.services = new Map();
  }

  // æ³¨å†ŒæœåŠ¡
  register(name, factory) {
    this.services.set(name, factory);
  }

  // è·å–æœåŠ¡ï¼ˆè‡ªåŠ¨åˆ›å»ºå®ä¾‹ï¼‰
  get(name) {
    const factory = this.services.get(name);
    if (!factory) {
      throw new Error(`Service ${name} not found`);
    }
    return factory(this);
  }
}

// åˆ›å»ºå®¹å™¨å®ä¾‹
const container = new DIContainer();

// æ³¨å†Œä¾èµ–
container.register('apiClient', () => {
  return axios.create({
    baseURL: process.env.REACT_APP_API_URL,
    timeout: 5000,
  });
});

container.register('logger', () => {
  return {
    log: (...args) => console.log('[LOG]', ...args),
    error: (...args) => console.error('[ERROR]', ...args),
  };
});

container.register('cache', () => {
  return new Map();
});

// æ³¨å†Œ UserServiceï¼Œè‡ªåŠ¨æ³¨å…¥ä¾èµ–
container.register('userService', (container) => {
  return new UserService(
    container.get('apiClient'),
    container.get('logger'),
    container.get('cache')
  );
});

export default container;
```

```javascript
// UserProfile.jsx - é€šè¿‡ props æ³¨å…¥ä¾èµ–
function UserProfile({ userId, userService }) {
  const [user, setUser] = React.useState(null);

  React.useEffect(() => {
    userService.getUser(userId).then(setUser);
  }, [userId, userService]);

  return user ? <div>{user.name}</div> : <div>åŠ è½½ä¸­...</div>;
}

// App.jsx - åœ¨é¡¶å±‚æ³¨å…¥ä¾èµ–
import container from './di-container';

function App() {
  const userService = container.get('userService');

  return <UserProfile userId={1} userService={userService} />;
}
```

```javascript
// UserProfile.test.js - è½»æ¾æµ‹è¯•ï¼
import { render } from '@testing-library/react';
import UserProfile from './UserProfile';

test('æ˜¾ç¤ºç”¨æˆ·åç§°', async () => {
  // Mock userService
  const mockUserService = {
    getUser: jest.fn().mockResolvedValue({ name: 'å¼ ä¸‰' }),
  };

  const { findByText } = render(
    <UserProfile userId={1} userService={mockUserService} />
  );

  expect(await findByText('å¼ ä¸‰')).toBeInTheDocument();
  expect(mockUserService.getUser).toHaveBeenCalledWith(1);
});
```

**æ•ˆæœ**ï¼š
- âœ… **æ˜“äºæµ‹è¯•**ï¼šå¯ä»¥è½»æ¾ mock ä¾èµ–
- âœ… **çµæ´»é…ç½®**ï¼šå¼€å‘/æµ‹è¯•/ç”Ÿäº§ä½¿ç”¨ä¸åŒä¾èµ–
- âœ… **æ¾è€¦åˆ**ï¼šUserService ä¸ä¾èµ–å…·ä½“å®ç°
- âœ… **å¯å¤ç”¨**ï¼šåŒä¸€ä¸ª UserService å¯ç”¨äºä¸åŒåœºæ™¯

---

### ğŸ¯ React ä¸­çš„ä¾èµ–æ³¨å…¥æ¨¡å¼

#### æ–¹å¼1ï¼šReact Contextï¼ˆæ¨èï¼‰

```javascript
// ServiceContext.jsx - ä½¿ç”¨ Context å®ç° DI
import React from 'react';
import container from './di-container';

const ServiceContext = React.createContext(null);

export function ServiceProvider({ children }) {
  const services = {
    userService: container.get('userService'),
    productService: container.get('productService'),
    cartService: container.get('cartService'),
  };

  return (
    <ServiceContext.Provider value={services}>
      {children}
    </ServiceContext.Provider>
  );
}

// è‡ªå®šä¹‰ Hook
export function useService(serviceName) {
  const services = React.useContext(ServiceContext);
  if (!services) {
    throw new Error('useService must be used within ServiceProvider');
  }
  return services[serviceName];
}
```

```javascript
// App.jsx
import { ServiceProvider } from './ServiceContext';

function App() {
  return (
    <ServiceProvider>
      <UserProfile userId={1} />
      <ProductList />
      <ShoppingCart />
    </ServiceProvider>
  );
}
```

```javascript
// UserProfile.jsx - ä½¿ç”¨æ³¨å…¥çš„æœåŠ¡
import { useService } from './ServiceContext';

function UserProfile({ userId }) {
  const userService = useService('userService');
  const [user, setUser] = React.useState(null);

  React.useEffect(() => {
    userService.getUser(userId).then(setUser);
  }, [userId, userService]);

  return user ? <div>{user.name}</div> : <div>åŠ è½½ä¸­...</div>;
}
```

#### æ–¹å¼2ï¼šé«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰æ³¨å…¥

```javascript
// withServices.jsx - HOC å®ç° DI
import React from 'react';
import container from './di-container';

export function withServices(...serviceNames) {
  return function(Component) {
    return function WithServicesComponent(props) {
      const services = {};
      serviceNames.forEach(name => {
        services[name] = container.get(name);
      });

      return <Component {...props} {...services} />;
    };
  };
}
```

```javascript
// UserProfile.jsx - ä½¿ç”¨ HOC æ³¨å…¥
function UserProfile({ userId, userService }) {
  const [user, setUser] = React.useState(null);

  React.useEffect(() => {
    userService.getUser(userId).then(setUser);
  }, [userId, userService]);

  return user ? <div>{user.name}</div> : <div>åŠ è½½ä¸­...</div>;
}

export default withServices('userService')(UserProfile);
```

---

### ğŸ—ï¸ çœŸå®ä¸šåŠ¡åœºæ™¯

#### åœºæ™¯1ï¼šå¯æµ‹è¯•çš„æ•°æ®å±‚

```javascript
// repositories/UserRepository.js
class UserRepository {
  constructor(apiClient) {
    this.apiClient = apiClient;
  }

  async findById(id) {
    const response = await this.apiClient.get(`/users/${id}`);
    return response.data;
  }

  async findAll() {
    const response = await this.apiClient.get('/users');
    return response.data;
  }

  async create(userData) {
    const response = await this.apiClient.post('/users', userData);
    return response.data;
  }
}

export default UserRepository;
```

```javascript
// services/UserService.js
class UserService {
  constructor(userRepository, logger) {
    this.repository = userRepository;
    this.logger = logger;
  }

  async getUserProfile(id) {
    try {
      this.logger.log('è·å–ç”¨æˆ·èµ„æ–™:', id);
      const user = await this.repository.findById(id);

      // ä¸šåŠ¡é€»è¾‘ï¼šæ ¼å¼åŒ–ç”¨æˆ·æ•°æ®
      return {
        ...user,
        displayName: `${user.firstName} ${user.lastName}`,
        isActive: user.status === 'active',
      };
    } catch (error) {
      this.logger.error('è·å–ç”¨æˆ·èµ„æ–™å¤±è´¥:', error);
      throw error;
    }
  }
}

export default UserService;
```

```javascript
// di-container.js
import axios from 'axios';
import UserRepository from './repositories/UserRepository';
import UserService from './services/UserService';

const container = new DIContainer();

// æ³¨å†Œ API å®¢æˆ·ç«¯
container.register('apiClient', () =>
  axios.create({
    baseURL: process.env.REACT_APP_API_URL,
  })
);

// æ³¨å†Œ Logger
container.register('logger', () => ({
  log: (...args) => console.log(...args),
  error: (...args) => console.error(...args),
}));

// æ³¨å†Œ Repository
container.register('userRepository', (c) =>
  new UserRepository(c.get('apiClient'))
);

// æ³¨å†Œ Service
container.register('userService', (c) =>
  new UserService(
    c.get('userRepository'),
    c.get('logger')
  )
);

export default container;
```

```javascript
// UserService.test.js - å®Œç¾çš„å•å…ƒæµ‹è¯•
import UserService from './UserService';

describe('UserService', () => {
  test('è·å–ç”¨æˆ·èµ„æ–™', async () => {
    // Mock ä¾èµ–
    const mockRepository = {
      findById: jest.fn().mockResolvedValue({
        id: 1,
        firstName: 'å¼ ',
        lastName: 'ä¸‰',
        status: 'active',
      }),
    };

    const mockLogger = {
      log: jest.fn(),
      error: jest.fn(),
    };

    // æ³¨å…¥ mock ä¾èµ–
    const userService = new UserService(mockRepository, mockLogger);

    // æ‰§è¡Œæµ‹è¯•
    const user = await userService.getUserProfile(1);

    // æ–­è¨€
    expect(user.displayName).toBe('å¼  ä¸‰');
    expect(user.isActive).toBe(true);
    expect(mockRepository.findById).toHaveBeenCalledWith(1);
    expect(mockLogger.log).toHaveBeenCalled();
  });
});
```

#### åœºæ™¯2ï¼šç¯å¢ƒé…ç½®æ³¨å…¥

```javascript
// config.js - ä¸åŒç¯å¢ƒçš„é…ç½®
export const developmentConfig = {
  apiUrl: 'http://localhost:3000',
  logLevel: 'debug',
  enableMock: true,
};

export const productionConfig = {
  apiUrl: 'https://api.production.com',
  logLevel: 'error',
  enableMock: false,
};

export const testConfig = {
  apiUrl: 'http://test-api.com',
  logLevel: 'silent',
  enableMock: true,
};
```

```javascript
// di-container.js - æ ¹æ®ç¯å¢ƒæ³¨å…¥ä¸åŒé…ç½®
const env = process.env.NODE_ENV;
const configs = {
  development: developmentConfig,
  production: productionConfig,
  test: testConfig,
};

const config = configs[env] || developmentConfig;

container.register('config', () => config);

container.register('apiClient', (c) => {
  const config = c.get('config');
  return axios.create({
    baseURL: config.apiUrl,
  });
});

container.register('logger', (c) => {
  const config = c.get('config');

  if (config.logLevel === 'silent') {
    return {
      log: () => {},
      error: () => {},
    };
  }

  return {
    log: (...args) => console.log(...args),
    error: (...args) => console.error(...args),
  };
});
```

---

### ğŸ¨ åœ¨ä¸»æµæ¡†æ¶ä¸­çš„åº”ç”¨

#### Angular - å†…ç½® DI ç³»ç»Ÿ

```typescript
// Angular çš„ä¾èµ–æ³¨å…¥æ˜¯æ¡†æ¶æ ¸å¿ƒ
import { Injectable } from '@angular/core';
import { HttpClient } from '@angular/common/http';

@Injectable({
  providedIn: 'root' // å•ä¾‹æ³¨å…¥
})
export class UserService {
  constructor(
    private http: HttpClient, // è‡ªåŠ¨æ³¨å…¥ HttpClient
    private logger: LoggerService // è‡ªåŠ¨æ³¨å…¥ LoggerService
  ) {}

  getUser(id: number) {
    return this.http.get(`/users/${id}`);
  }
}

// ç»„ä»¶ä¸­ä½¿ç”¨
export class UserComponent {
  constructor(private userService: UserService) {} // è‡ªåŠ¨æ³¨å…¥
}
```

#### React Context - DI çš„å®ç°

```javascript
// React Context æœ¬è´¨ä¸Šå°±æ˜¯ä¾èµ–æ³¨å…¥
const ThemeContext = React.createContext();

function App() {
  return (
    <ThemeContext.Provider value={{ color: 'blue' }}>
      <Header />
    </ThemeContext.Provider>
  );
}

function Header() {
  const theme = React.useContext(ThemeContext); // æ³¨å…¥ä¸»é¢˜
  return <div style={{ color: theme.color }}>Header</div>;
}
```

#### Vue 3 provide/inject

```javascript
// Vue 3 çš„ provide/inject å®ç° DI
import { provide, inject } from 'vue';

// çˆ¶ç»„ä»¶æä¾›ä¾èµ–
export default {
  setup() {
    const userService = new UserService();
    provide('userService', userService);
  }
}

// å­ç»„ä»¶æ³¨å…¥ä¾èµ–
export default {
  setup() {
    const userService = inject('userService');
    return { userService };
  }
}
```

---

### âš–ï¸ ä¼˜ç¼ºç‚¹åˆ†æ

#### âœ… ä¼˜ç‚¹

1. **æ˜“äºæµ‹è¯•**ï¼šå¯ä»¥è½»æ¾ mock ä¾èµ–
2. **æ¾è€¦åˆ**ï¼šç»„ä»¶ä¸ä¾èµ–å…·ä½“å®ç°
3. **çµæ´»é…ç½®**ï¼šä¸åŒç¯å¢ƒä½¿ç”¨ä¸åŒä¾èµ–
4. **å¯ç»´æŠ¤æ€§**ï¼šä¾èµ–å…³ç³»æ¸…æ™°æ˜ç¡®
5. **å¯å¤ç”¨æ€§**ï¼šåŒä¸€ç»„ä»¶å¯ç”¨äºä¸åŒåœºæ™¯

#### âŒ ç¼ºç‚¹

1. **å­¦ä¹ æ›²çº¿**ï¼šéœ€è¦ç†è§£ IoC å’Œ DI æ¦‚å¿µ
2. **å¤æ‚åº¦**ï¼šå¢åŠ äº†ä»£ç å±‚æ¬¡
3. **è¿‡åº¦è®¾è®¡**ï¼šç®€å•é¡¹ç›®å¯èƒ½ä¸éœ€è¦
4. **æ€§èƒ½å¼€é”€**ï¼šDI å®¹å™¨æœ‰ä¸€å®šæ€§èƒ½å¼€é”€

---

### ğŸ“‹ ä½•æ—¶ä½¿ç”¨ä¾èµ–æ³¨å…¥

#### âœ… é€‚åˆä½¿ç”¨çš„åœºæ™¯

- å¤§å‹åº”ç”¨ï¼Œéœ€è¦ç®¡ç†å¤æ‚ä¾èµ–å…³ç³»
- éœ€è¦ç¼–å†™å¤§é‡å•å…ƒæµ‹è¯•
- å¤šç¯å¢ƒéƒ¨ç½²ï¼ˆå¼€å‘/æµ‹è¯•/ç”Ÿäº§ï¼‰
- éœ€è¦è¿è¡Œæ—¶æ›¿æ¢ä¾èµ–
- æ’ä»¶ç³»ç»Ÿã€å¯æ‰©å±•æ¶æ„

#### âŒ ä¸é€‚åˆä½¿ç”¨çš„åœºæ™¯

- å°å‹é¡¹ç›®ï¼Œä¾èµ–å…³ç³»ç®€å•
- ä¸éœ€è¦æµ‹è¯•çš„åŸå‹é¡¹ç›®
- æ€§èƒ½è¦æ±‚æé«˜çš„åœºæ™¯
- å›¢é˜Ÿä¸ç†Ÿæ‚‰ DI æ¦‚å¿µ

---

### ğŸ“ ä¾èµ–æ³¨å…¥æœ€ä½³å®è·µ

```javascript
// âœ… å¥½çš„å®è·µï¼šé€šè¿‡æ„é€ å‡½æ•°æ³¨å…¥
class OrderService {
  constructor(paymentService, emailService) {
    this.paymentService = paymentService;
    this.emailService = emailService;
  }

  async createOrder(orderData) {
    const payment = await this.paymentService.process(orderData);
    await this.emailService.sendConfirmation(orderData);
    return payment;
  }
}

// âŒ åçš„å®è·µï¼šåœ¨å†…éƒ¨ç›´æ¥åˆ›å»ºä¾èµ–
class OrderService {
  async createOrder(orderData) {
    const paymentService = new PaymentService(); // ç¡¬ç¼–ç ï¼
    const emailService = new EmailService(); // ç¡¬ç¼–ç ï¼

    const payment = await paymentService.process(orderData);
    await emailService.sendConfirmation(orderData);
    return payment;
  }
}
```

---

## å»ºé€ è€…æ¨¡å¼

### ğŸ’¡ æ¨¡å¼å®šä¹‰
å»ºé€ è€…æ¨¡å¼ï¼ˆBuilder Patternï¼‰å°†å¤æ‚å¯¹è±¡çš„æ„å»ºä¸å…¶è¡¨ç¤ºåˆ†ç¦»ï¼Œä½¿å¾—åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„è¡¨ç¤ºã€‚

### ğŸ¤” ä¸ºä»€ä¹ˆéœ€è¦å»ºé€ è€…æ¨¡å¼ï¼Ÿ

#### é—®é¢˜åœºæ™¯ï¼šæ„å»ºå¤æ‚é…ç½®å¯¹è±¡

å‡è®¾ä½ åœ¨å¼€å‘ä¸€ä¸ª HTTP è¯·æ±‚åº“ï¼Œéœ€è¦æ”¯æŒå„ç§é…ç½®é€‰é¡¹ï¼š

#### âŒ ä¸ä½¿ç”¨å»ºé€ è€…æ¨¡å¼çš„ç—›ç‚¹

```javascript
// HttpClient.js - æ„é€ å‡½æ•°å‚æ•°è¿‡å¤š
class HttpClient {
  constructor(
    baseURL,
    timeout,
    headers,
    withCredentials,
    responseType,
    maxRedirects,
    validateStatus,
    transformRequest,
    transformResponse,
    cancelToken
  ) {
    this.baseURL = baseURL;
    this.timeout = timeout;
    this.headers = headers;
    this.withCredentials = withCredentials;
    this.responseType = responseType;
    this.maxRedirects = maxRedirects;
    this.validateStatus = validateStatus;
    this.transformRequest = transformRequest;
    this.transformResponse = transformResponse;
    this.cancelToken = cancelToken;
  }

  request(url, options) {
    // ... è¯·æ±‚é€»è¾‘
  }
}

// ä½¿ç”¨æ—¶éå¸¸æ··ä¹±
const client = new HttpClient(
  'https://api.example.com', // baseURL
  5000,                       // timeout
  { 'Content-Type': 'application/json' }, // headers
  true,                       // withCredentials
  'json',                     // responseType
  5,                          // maxRedirects
  null,                       // validateStatus
  null,                       // transformRequest
  null,                       // transformResponse
  null                        // cancelToken
);

// æƒ³è¦è·³è¿‡æŸäº›å‚æ•°ï¼Ÿå¿…é¡»ä¼  null æˆ– undefinedï¼
const simpleClient = new HttpClient(
  'https://api.example.com',
  undefined, // ä¸æƒ³è®¾ç½® timeout
  undefined, // ä¸æƒ³è®¾ç½® headers
  undefined, // ä¸æƒ³è®¾ç½® withCredentials
  'json'     // åªæƒ³è®¾ç½® responseType
);
```

**é—®é¢˜**ï¼š
- å‚æ•°è¿‡å¤šï¼Œéš¾ä»¥è®°å¿†é¡ºåº
- å¯é€‰å‚æ•°å¿…é¡»ä¼  undefined
- ä»£ç å¯è¯»æ€§å·®
- ä¿®æ”¹å‚æ•°é¡ºåºä¼šç ´åæ‰€æœ‰è°ƒç”¨

---

#### âœ… ä½¿ç”¨å»ºé€ è€…æ¨¡å¼è§£å†³

```javascript
// HttpClient.js - ä½¿ç”¨å»ºé€ è€…æ¨¡å¼
class HttpClient {
  constructor(config) {
    this.config = config;
  }

  async request(url, options = {}) {
    const config = { ...this.config, ...options };

    try {
      const response = await fetch(config.baseURL + url, {
        method: config.method || 'GET',
        headers: config.headers,
        body: config.data ? JSON.stringify(config.data) : undefined,
        credentials: config.withCredentials ? 'include' : 'same-origin',
        signal: config.cancelToken?.signal,
      });

      if (!response.ok) {
        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
      }

      return config.responseType === 'json'
        ? await response.json()
        : await response.text();
    } catch (error) {
      console.error('Request failed:', error);
      throw error;
    }
  }

  get(url, config) {
    return this.request(url, { ...config, method: 'GET' });
  }

  post(url, data, config) {
    return this.request(url, { ...config, method: 'POST', data });
  }
}

// HttpClientBuilder.js - å»ºé€ è€…ç±»
class HttpClientBuilder {
  constructor() {
    this.config = {
      baseURL: '',
      timeout: 5000,
      headers: {},
      withCredentials: false,
      responseType: 'json',
    };
  }

  // é“¾å¼è°ƒç”¨æ–¹æ³•
  setBaseURL(baseURL) {
    this.config.baseURL = baseURL;
    return this; // è¿”å› this æ”¯æŒé“¾å¼è°ƒç”¨
  }

  setTimeout(timeout) {
    this.config.timeout = timeout;
    return this;
  }

  setHeaders(headers) {
    this.config.headers = { ...this.config.headers, ...headers };
    return this;
  }

  addHeader(key, value) {
    this.config.headers[key] = value;
    return this;
  }

  withCredentials(enabled = true) {
    this.config.withCredentials = enabled;
    return this;
  }

  setResponseType(type) {
    this.config.responseType = type;
    return this;
  }

  // æ„å»ºæœ€ç»ˆå¯¹è±¡
  build() {
    return new HttpClient(this.config);
  }
}

export { HttpClient, HttpClientBuilder };
```

```javascript
// ä½¿ç”¨å»ºé€ è€…æ¨¡å¼ - æ¸…æ™°æ˜“è¯»ï¼
import { HttpClientBuilder } from './HttpClient';

const client = new HttpClientBuilder()
  .setBaseURL('https://api.example.com')
  .setTimeout(10000)
  .addHeader('Content-Type', 'application/json')
  .addHeader('Authorization', 'Bearer token123')
  .withCredentials()
  .setResponseType('json')
  .build();

// åªè®¾ç½®éœ€è¦çš„å‚æ•°
const simpleClient = new HttpClientBuilder()
  .setBaseURL('https://api.example.com')
  .setResponseType('json')
  .build();

// ä½¿ç”¨
client.get('/users').then(users => {
  console.log('ç”¨æˆ·åˆ—è¡¨:', users);
});

client.post('/users', { name: 'å¼ ä¸‰', age: 25 }).then(user => {
  console.log('åˆ›å»ºç”¨æˆ·æˆåŠŸ:', user);
});
```

**æ•ˆæœ**ï¼š
- âœ… ä»£ç æ¸…æ™°æ˜“è¯»ï¼Œå‚æ•°å«ä¹‰æ˜ç¡®
- âœ… é“¾å¼è°ƒç”¨ï¼Œæµç•…çš„ API
- âœ… å¯é€‰å‚æ•°ä¸éœ€è¦ä¼  undefined
- âœ… æ˜“äºæ‰©å±•æ–°é…ç½®é¡¹

---

### ğŸ¯ React ç»„ä»¶çš„å»ºé€ è€…æ¨¡å¼

```javascript
// Dialog.jsx - å¯¹è¯æ¡†ç»„ä»¶
function Dialog({ config }) {
  if (!config.visible) return null;

  return (
    <div className="dialog-overlay">
      <div className="dialog" style={{ width: config.width }}>
        {config.title && (
          <div className="dialog-header">
            <h3>{config.title}</h3>
            {config.closable && (
              <button onClick={config.onClose}>Ã—</button>
            )}
          </div>
        )}

        <div className="dialog-body">
          {config.content}
        </div>

        {config.footer && (
          <div className="dialog-footer">
            {config.footer}
          </div>
        )}
      </div>
    </div>
  );
}

// DialogBuilder.js - å¯¹è¯æ¡†å»ºé€ è€…
class DialogBuilder {
  constructor() {
    this.config = {
      visible: false,
      title: '',
      content: null,
      width: 520,
      closable: true,
      footer: null,
      onClose: () => {},
      onOk: () => {},
      onCancel: () => {},
    };
  }

  setTitle(title) {
    this.config.title = title;
    return this;
  }

  setContent(content) {
    this.config.content = content;
    return this;
  }

  setWidth(width) {
    this.config.width = width;
    return this;
  }

  setVisible(visible) {
    this.config.visible = visible;
    return this;
  }

  setClosable(closable) {
    this.config.closable = closable;
    return this;
  }

  withFooter(footer) {
    this.config.footer = footer;
    return this;
  }

  // é¢„è®¾æ ·å¼
  asConfirm() {
    this.config.footer = (
      <div>
        <button onClick={this.config.onCancel}>å–æ¶ˆ</button>
        <button onClick={this.config.onOk}>ç¡®å®š</button>
      </div>
    );
    return this;
  }

  asAlert() {
    this.config.closable = false;
    this.config.footer = (
      <button onClick={this.config.onOk}>çŸ¥é“äº†</button>
    );
    return this;
  }

  onOk(callback) {
    this.config.onOk = callback;
    return this;
  }

  onCancel(callback) {
    this.config.onCancel = callback;
    return this;
  }

  onClose(callback) {
    this.config.onClose = callback;
    return this;
  }

  build() {
    return this.config;
  }
}

export { Dialog, DialogBuilder };
```

```javascript
// ä½¿ç”¨ç¤ºä¾‹
import { Dialog, DialogBuilder } from './Dialog';

function App() {
  const [dialogConfig, setDialogConfig] = React.useState(null);

  const showConfirmDialog = () => {
    const config = new DialogBuilder()
      .setTitle('ç¡®è®¤åˆ é™¤')
      .setContent('ç¡®å®šè¦åˆ é™¤è¿™æ¡è®°å½•å—ï¼Ÿ')
      .setVisible(true)
      .asConfirm()
      .onOk(() => {
        console.log('ç”¨æˆ·ç‚¹å‡»äº†ç¡®å®š');
        setDialogConfig(null);
      })
      .onCancel(() => {
        console.log('ç”¨æˆ·ç‚¹å‡»äº†å–æ¶ˆ');
        setDialogConfig(null);
      })
      .build();

    setDialogConfig(config);
  };

  const showAlertDialog = () => {
    const config = new DialogBuilder()
      .setTitle('æ“ä½œæˆåŠŸ')
      .setContent('æ‚¨çš„ä¿®æ”¹å·²ä¿å­˜')
      .setVisible(true)
      .asAlert()
      .onOk(() => setDialogConfig(null))
      .build();

    setDialogConfig(config);
  };

  const showCustomDialog = () => {
    const config = new DialogBuilder()
      .setTitle('è‡ªå®šä¹‰å¯¹è¯æ¡†')
      .setContent(<div>è¿™æ˜¯è‡ªå®šä¹‰å†…å®¹</div>)
      .setWidth(800)
      .setVisible(true)
      .withFooter(
        <div>
          <button>è‡ªå®šä¹‰æŒ‰é’®1</button>
          <button>è‡ªå®šä¹‰æŒ‰é’®2</button>
        </div>
      )
      .onClose(() => setDialogConfig(null))
      .build();

    setDialogConfig(config);
  };

  return (
    <div>
      <button onClick={showConfirmDialog}>æ˜¾ç¤ºç¡®è®¤å¯¹è¯æ¡†</button>
      <button onClick={showAlertDialog}>æ˜¾ç¤ºæç¤ºå¯¹è¯æ¡†</button>
      <button onClick={showCustomDialog}>æ˜¾ç¤ºè‡ªå®šä¹‰å¯¹è¯æ¡†</button>

      {dialogConfig && <Dialog config={dialogConfig} />}
    </div>
  );
}
```

---

### ğŸ—ï¸ çœŸå®ä¸šåŠ¡åœºæ™¯

#### åœºæ™¯1ï¼šSQL æŸ¥è¯¢æ„å»ºå™¨

```javascript
// QueryBuilder.js
class QueryBuilder {
  constructor() {
    this.query = {
      table: '',
      columns: ['*'],
      where: [],
      orderBy: [],
      limit: null,
      offset: null,
    };
  }

  from(table) {
    this.query.table = table;
    return this;
  }

  select(...columns) {
    this.query.columns = columns;
    return this;
  }

  where(condition, operator = '=', value) {
    this.query.where.push({ condition, operator, value });
    return this;
  }

  orderBy(column, direction = 'ASC') {
    this.query.orderBy.push({ column, direction });
    return this;
  }

  limit(count) {
    this.query.limit = count;
    return this;
  }

  offset(count) {
    this.query.offset = count;
    return this;
  }

  build() {
    let sql = `SELECT ${this.query.columns.join(', ')} FROM ${this.query.table}`;

    if (this.query.where.length > 0) {
      const conditions = this.query.where
        .map(w => `${w.condition} ${w.operator} '${w.value}'`)
        .join(' AND ');
      sql += ` WHERE ${conditions}`;
    }

    if (this.query.orderBy.length > 0) {
      const orders = this.query.orderBy
        .map(o => `${o.column} ${o.direction}`)
        .join(', ');
      sql += ` ORDER BY ${orders}`;
    }

    if (this.query.limit) {
      sql += ` LIMIT ${this.query.limit}`;
    }

    if (this.query.offset) {
      sql += ` OFFSET ${this.query.offset}`;
    }

    return sql;
  }
}

export default QueryBuilder;
```

```javascript
// ä½¿ç”¨æŸ¥è¯¢æ„å»ºå™¨
import QueryBuilder from './QueryBuilder';

const query1 = new QueryBuilder()
  .from('users')
  .select('id', 'name', 'email')
  .where('age', '>', 18)
  .where('status', '=', 'active')
  .orderBy('created_at', 'DESC')
  .limit(10)
  .build();

console.log(query1);
// SELECT id, name, email FROM users
// WHERE age > '18' AND status = 'active'
// ORDER BY created_at DESC
// LIMIT 10

const query2 = new QueryBuilder()
  .from('products')
  .where('category', '=', 'electronics')
  .orderBy('price', 'ASC')
  .build();

console.log(query2);
// SELECT * FROM products
// WHERE category = 'electronics'
// ORDER BY price ASC
```

#### åœºæ™¯2ï¼šè¡¨å•éªŒè¯å™¨æ„å»ºå™¨

```javascript
// FormValidatorBuilder.js
class FormValidatorBuilder {
  constructor() {
    this.rules = [];
  }

  required(message = 'æ­¤å­—æ®µä¸ºå¿…å¡«é¡¹') {
    this.rules.push({
      type: 'required',
      message,
      validate: (value) => {
        return value !== null && value !== undefined && value !== '';
      },
    });
    return this;
  }

  minLength(length, message) {
    this.rules.push({
      type: 'minLength',
      message: message || `æœ€å°‘éœ€è¦ ${length} ä¸ªå­—ç¬¦`,
      validate: (value) => {
        return value && value.length >= length;
      },
    });
    return this;
  }

  maxLength(length, message) {
    this.rules.push({
      type: 'maxLength',
      message: message || `æœ€å¤šå…è®¸ ${length} ä¸ªå­—ç¬¦`,
      validate: (value) => {
        return !value || value.length <= length;
      },
    });
    return this;
  }

  email(message = 'è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€') {
    this.rules.push({
      type: 'email',
      message,
      validate: (value) => {
        const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return !value || regex.test(value);
      },
    });
    return this;
  }

  pattern(regex, message = 'æ ¼å¼ä¸æ­£ç¡®') {
    this.rules.push({
      type: 'pattern',
      message,
      validate: (value) => {
        return !value || regex.test(value);
      },
    });
    return this;
  }

  custom(validateFn, message) {
    this.rules.push({
      type: 'custom',
      message,
      validate: validateFn,
    });
    return this;
  }

  build() {
    return (value) => {
      for (const rule of this.rules) {
        if (!rule.validate(value)) {
          return { valid: false, message: rule.message };
        }
      }
      return { valid: true };
    };
  }
}

export default FormValidatorBuilder;
```

```javascript
// ä½¿ç”¨éªŒè¯å™¨æ„å»ºå™¨
import FormValidatorBuilder from './FormValidatorBuilder';

// ç”¨æˆ·åéªŒè¯
const usernameValidator = new FormValidatorBuilder()
  .required('ç”¨æˆ·åä¸èƒ½ä¸ºç©º')
  .minLength(3, 'ç”¨æˆ·åè‡³å°‘3ä¸ªå­—ç¬¦')
  .maxLength(20, 'ç”¨æˆ·åæœ€å¤š20ä¸ªå­—ç¬¦')
  .pattern(/^[a-zA-Z0-9_]+$/, 'ç”¨æˆ·ååªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿')
  .build();

// é‚®ç®±éªŒè¯
const emailValidator = new FormValidatorBuilder()
  .required('é‚®ç®±ä¸èƒ½ä¸ºç©º')
  .email()
  .build();

// å¯†ç éªŒè¯
const passwordValidator = new FormValidatorBuilder()
  .required('å¯†ç ä¸èƒ½ä¸ºç©º')
  .minLength(8, 'å¯†ç è‡³å°‘8ä¸ªå­—ç¬¦')
  .custom(
    (value) => /[A-Z]/.test(value) && /[a-z]/.test(value) && /[0-9]/.test(value),
    'å¯†ç å¿…é¡»åŒ…å«å¤§å†™å­—æ¯ã€å°å†™å­—æ¯å’Œæ•°å­—'
  )
  .build();

// ä½¿ç”¨
console.log(usernameValidator('ab'));        // { valid: false, message: 'ç”¨æˆ·åè‡³å°‘3ä¸ªå­—ç¬¦' }
console.log(usernameValidator('abc123'));    // { valid: true }
console.log(emailValidator('test@test.com')); // { valid: true }
console.log(passwordValidator('12345678'));  // { valid: false, message: 'å¯†ç å¿…é¡»åŒ…å«...' }
```

---

### ğŸ¨ åœ¨ä¸»æµæ¡†æ¶ä¸­çš„åº”ç”¨

#### Axios é…ç½® - å»ºé€ è€…æ¨¡å¼

```javascript
// Axios ä½¿ç”¨å»ºé€ è€…æ¨¡å¼é…ç½®è¯·æ±‚
const axiosInstance = axios.create({
  baseURL: 'https://api.example.com',
  timeout: 5000,
  headers: { 'X-Custom-Header': 'foobar' }
});

// é“¾å¼é…ç½®è¯·æ±‚
axiosInstance
  .get('/users')
  .then(response => console.log(response.data))
  .catch(error => console.error(error));
```

#### React Query Builder

```javascript
// React Query çš„é…ç½®ä¹Ÿç±»ä¼¼å»ºé€ è€…æ¨¡å¼
const query = useQuery({
  queryKey: ['users'],
  queryFn: fetchUsers,
  staleTime: 5000,
  cacheTime: 10000,
  retry: 3,
  retryDelay: 1000,
});
```

---

### âš–ï¸ ä¼˜ç¼ºç‚¹åˆ†æ

#### âœ… ä¼˜ç‚¹

1. **å¯è¯»æ€§å¼º**ï¼šé“¾å¼è°ƒç”¨ï¼Œä»£ç æ¸…æ™°
2. **çµæ´»ç»„åˆ**ï¼šå¯é€‰å‚æ•°ï¼Œéšæ„ç»„åˆ
3. **æ˜“äºæ‰©å±•**ï¼šæ–°å¢é…ç½®é¡¹ä¸å½±å“ç°æœ‰ä»£ç 
4. **å°è£…å¤æ‚æ€§**ï¼šéšè—å¤æ‚çš„æ„å»ºé€»è¾‘
5. **ä¸å¯å˜æ€§**ï¼šå¯ä»¥å®ç°ä¸å¯å˜å¯¹è±¡

#### âŒ ç¼ºç‚¹

1. **ä»£ç é‡å¢åŠ **ï¼šéœ€è¦é¢å¤–çš„å»ºé€ è€…ç±»
2. **å¯¹è±¡åˆ›å»ºå¼€é”€**ï¼šå¤šä¸€å±‚å»ºé€ è€…å¯¹è±¡
3. **è¿‡åº¦è®¾è®¡**ï¼šç®€å•å¯¹è±¡ä¸éœ€è¦å»ºé€ è€…

---

### ğŸ“‹ ä½•æ—¶ä½¿ç”¨å»ºé€ è€…æ¨¡å¼

#### âœ… é€‚åˆä½¿ç”¨çš„åœºæ™¯

- æ„é€ å‡½æ•°å‚æ•°è¿‡å¤šï¼ˆ>4ä¸ªï¼‰
- æœ‰å¤§é‡å¯é€‰å‚æ•°
- éœ€è¦åˆ›å»ºä¸å¯å˜å¯¹è±¡
- æ„å»ºè¿‡ç¨‹å¤æ‚ï¼Œéœ€è¦å¤šæ­¥éª¤
- éœ€è¦åˆ›å»ºå¤šç§é…ç½®çš„å¯¹è±¡

#### âŒ ä¸é€‚åˆä½¿ç”¨çš„åœºæ™¯

- å¯¹è±¡ç»“æ„ç®€å•ï¼ˆ<4ä¸ªå‚æ•°ï¼‰
- ä¸éœ€è¦çµæ´»é…ç½®
- æ€§èƒ½è¦æ±‚æé«˜çš„åœºæ™¯
- å¯¹è±¡åˆ›å»ºéå¸¸é¢‘ç¹

---

### ğŸ“ å»ºé€ è€…æ¨¡å¼æœ€ä½³å®è·µ

```javascript
// âœ… å¥½çš„å®è·µï¼šæ”¯æŒå¤šç§æ„å»ºæ–¹å¼
class HttpClientBuilder {
  // æ–¹å¼1ï¼šé“¾å¼è°ƒç”¨
  setBaseURL(url) {
    this.config.baseURL = url;
    return this;
  }

  // æ–¹å¼2ï¼šæ‰¹é‡é…ç½®
  configure(config) {
    Object.assign(this.config, config);
    return this;
  }

  // æ–¹å¼3ï¼šé¢„è®¾é…ç½®
  asProduction() {
    this.config.baseURL = 'https://api.production.com';
    this.config.timeout = 10000;
    return this;
  }

  asDevelopment() {
    this.config.baseURL = 'http://localhost:3000';
    this.config.timeout = 30000;
    return this;
  }
}

// ä½¿ç”¨
const client1 = new HttpClientBuilder()
  .setBaseURL('https://api.example.com')
  .setTimeout(5000)
  .build();

const client2 = new HttpClientBuilder()
  .asProduction()
  .build();

const client3 = new HttpClientBuilder()
  .configure({
    baseURL: 'https://api.example.com',
    timeout: 5000,
  })
  .build();
```

---

## ğŸ“ æ€»ç»“

### åˆ›å»ºå‹æ¨¡å¼å¯¹æ¯”

| æ¨¡å¼ | æ ¸å¿ƒç›®çš„ | ä½¿ç”¨åœºæ™¯ | ä¼˜å…ˆçº§ |
|-----|---------|---------|-------|
| **å•ä¾‹æ¨¡å¼** | ç¡®ä¿åªæœ‰ä¸€ä¸ªå®ä¾‹ | å…¨å±€é…ç½®ã€çŠ¶æ€ç®¡ç† | â­â­â­â­â­ |
| **å·¥å‚æ¨¡å¼** | æ ¹æ®ç±»å‹åˆ›å»ºå¯¹è±¡ | åŠ¨æ€ç»„ä»¶ã€è¡¨å•ç”Ÿæˆå™¨ | â­â­â­â­â­ |
| **ä¾èµ–æ³¨å…¥** | è§£è€¦ä¾èµ–å…³ç³» | æµ‹è¯•ã€å¤šç¯å¢ƒé…ç½® | â­â­â­â­ |
| **å»ºé€ è€…æ¨¡å¼** | æ„å»ºå¤æ‚å¯¹è±¡ | é“¾å¼APIã€é…ç½®å¯¹è±¡ | â­â­â­â­ |

### å­¦ä¹ å»ºè®®

1. **å•ä¾‹æ¨¡å¼**ï¼šå…ˆæŒæ¡åŸºæœ¬å®ç°ï¼Œå†å­¦ä¹  React Context æ›¿ä»£æ–¹æ¡ˆ
2. **å·¥å‚æ¨¡å¼**ï¼šç†è§£å¦‚ä½•ç”¨ç»„ä»¶æ³¨å†Œè¡¨æ›¿ä»£ if-else
3. **ä¾èµ–æ³¨å…¥**ï¼šé‡ç‚¹ç†è§£ IoC æ€æƒ³ï¼Œåœ¨æµ‹è¯•ä¸­å®è·µ
4. **å»ºé€ è€…æ¨¡å¼**ï¼šå­¦ä¹ é“¾å¼è°ƒç”¨çš„ä¼˜é›… API è®¾è®¡

---

**ä¸‹ä¸€æ­¥**ï¼šç»§ç»­å­¦ä¹  [ç»“æ„å‹æ¨¡å¼](./02-ç»“æ„å‹æ¨¡å¼.md)ï¼Œå­¦ä¹ å¦‚ä½•ç»„ç»‡ä»£ç ç»“æ„ã€‚

ğŸ‰ æ­å–œå®Œæˆåˆ›å»ºå‹æ¨¡å¼çš„å­¦ä¹ ï¼
