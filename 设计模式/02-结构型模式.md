# ç¬¬äºŒéƒ¨åˆ†ï¼šç»“æ„å‹æ¨¡å¼

> ç»“æ„å‹æ¨¡å¼å…³æ³¨ç±»å’Œå¯¹è±¡çš„ç»„åˆï¼Œå¸®åŠ©ä½ æ„å»ºæ›´çµæ´»ã€æ›´æ˜“ç»´æŠ¤çš„ä»£ç ç»“æ„

## ç›®å½•
- [è£…é¥°å™¨æ¨¡å¼ (Decorator)](#è£…é¥°å™¨æ¨¡å¼)
- [ä»£ç†æ¨¡å¼ (Proxy)](#ä»£ç†æ¨¡å¼)
- [é€‚é…å™¨æ¨¡å¼ (Adapter)](#é€‚é…å™¨æ¨¡å¼)
- [å¤–è§‚æ¨¡å¼ (Facade)](#å¤–è§‚æ¨¡å¼)

---

## è£…é¥°å™¨æ¨¡å¼

### ğŸ’¡ æ¨¡å¼å®šä¹‰
è£…é¥°å™¨æ¨¡å¼ï¼ˆDecorator Patternï¼‰å…è®¸åœ¨ä¸æ”¹å˜å¯¹è±¡è‡ªèº«çš„åŸºç¡€ä¸Šï¼ŒåŠ¨æ€åœ°ç»™å¯¹è±¡æ·»åŠ æ–°çš„åŠŸèƒ½ã€‚å®ƒæ˜¯é€šè¿‡åˆ›å»ºåŒ…è£…å¯¹è±¡æ¥å®ç°çš„ã€‚

### ğŸ¤” ä¸ºä»€ä¹ˆéœ€è¦è£…é¥°å™¨æ¨¡å¼ï¼Ÿ

#### é—®é¢˜åœºæ™¯ï¼šç»™ç»„ä»¶æ·»åŠ æƒé™æ§åˆ¶ã€æ—¥å¿—ã€æ€§èƒ½ç›‘æ§ç­‰åŠŸèƒ½

å‡è®¾ä½ æœ‰ä¸€ä¸ªç”¨æˆ·ä¿¡æ¯é¡µé¢ï¼Œç°åœ¨éœ€è¦æ·»åŠ æƒé™æ§åˆ¶ã€åŠ è½½çŠ¶æ€ã€é”™è¯¯è¾¹ç•Œç­‰åŠŸèƒ½ï¼š

#### âŒ ä¸ä½¿ç”¨è£…é¥°å™¨æ¨¡å¼çš„ç—›ç‚¹

```javascript
// UserProfile.jsx - æ‰€æœ‰åŠŸèƒ½éƒ½è€¦åˆåœ¨ä¸€èµ·
function UserProfile({ userId }) {
  const [user, setUser] = React.useState(null);
  const [loading, setLoading] = React.useState(true);
  const [error, setError] = React.useState(null);
  const [hasPermission, setHasPermission] = React.useState(false);

  React.useEffect(() => {
    // æƒé™æ£€æŸ¥é€»è¾‘
    const checkPermission = async () => {
      try {
        const permission = await checkUserPermission();
        setHasPermission(permission);
      } catch (err) {
        setError('æƒé™æ£€æŸ¥å¤±è´¥');
      }
    };

    // æ•°æ®åŠ è½½é€»è¾‘
    const loadUser = async () => {
      if (!hasPermission) return;

      try {
        setLoading(true);

        // æ€§èƒ½ç›‘æ§
        const startTime = performance.now();

        // æ—¥å¿—è®°å½•
        console.log('å¼€å§‹åŠ è½½ç”¨æˆ·:', userId);

        const data = await fetchUser(userId);
        setUser(data);

        // æ€§èƒ½ç›‘æ§
        const endTime = performance.now();
        console.log(`åŠ è½½ç”¨æˆ·è€—æ—¶: ${endTime - startTime}ms`);

        // æ—¥å¿—è®°å½•
        console.log('ç”¨æˆ·åŠ è½½æˆåŠŸ:', data);
      } catch (err) {
        setError(err.message);
        console.error('ç”¨æˆ·åŠ è½½å¤±è´¥:', err);
      } finally {
        setLoading(false);
      }
    };

    checkPermission().then(loadUser);
  }, [userId, hasPermission]);

  // é”™è¯¯è¾¹ç•Œé€»è¾‘
  if (error) {
    return <div className="error">é”™è¯¯: {error}</div>;
  }

  // æƒé™æ£€æŸ¥é€»è¾‘
  if (!hasPermission) {
    return <div className="no-permission">æ‚¨æ²¡æœ‰æƒé™æŸ¥çœ‹æ­¤é¡µé¢</div>;
  }

  // åŠ è½½çŠ¶æ€é€»è¾‘
  if (loading) {
    return <div className="loading">åŠ è½½ä¸­...</div>;
  }

  // æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
  return (
    <div className="user-profile">
      <h1>{user.name}</h1>
      <p>é‚®ç®±: {user.email}</p>
      <p>å¹´é¾„: {user.age}</p>
    </div>
  );
}
```

**é—®é¢˜**ï¼š
- ç»„ä»¶èŒè´£è¿‡å¤šï¼šæƒé™ã€æ—¥å¿—ã€æ€§èƒ½ã€é”™è¯¯å¤„ç†ã€ä¸šåŠ¡é€»è¾‘å…¨éƒ¨æ··åœ¨ä¸€èµ·
- éš¾ä»¥å¤ç”¨ï¼šå…¶ä»–ç»„ä»¶ä¹Ÿéœ€è¦æƒé™ã€åŠ è½½ã€é”™è¯¯å¤„ç†æ—¶ï¼Œåªèƒ½å¤åˆ¶ç²˜è´´
- éš¾ä»¥æµ‹è¯•ï¼šæµ‹è¯•ä¸šåŠ¡é€»è¾‘å¿…é¡»åŒæ—¶å¤„ç†æ‰€æœ‰è¾…åŠ©é€»è¾‘
- éš¾ä»¥ç»´æŠ¤ï¼šä¿®æ”¹åŠ è½½é€»è¾‘å¯èƒ½å½±å“æƒé™æ£€æŸ¥

---

#### âœ… ä½¿ç”¨è£…é¥°å™¨æ¨¡å¼ï¼ˆHOCï¼‰è§£å†³

```javascript
// UserProfile.jsx - åªå…³æ³¨æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
function UserProfile({ user }) {
  return (
    <div className="user-profile">
      <h1>{user.name}</h1>
      <p>é‚®ç®±: {user.email}</p>
      <p>å¹´é¾„: {user.age}</p>
    </div>
  );
}

export default UserProfile;
```

```javascript
// decorators/withAuth.jsx - æƒé™è£…é¥°å™¨
function withAuth(requiredPermission) {
  return function(Component) {
    return function WithAuthComponent(props) {
      const [hasPermission, setHasPermission] = React.useState(null);

      React.useEffect(() => {
        checkUserPermission(requiredPermission).then(setHasPermission);
      }, []);

      if (hasPermission === null) {
        return <div>æ£€æŸ¥æƒé™ä¸­...</div>;
      }

      if (!hasPermission) {
        return <div className="no-permission">æ‚¨æ²¡æœ‰æƒé™æŸ¥çœ‹æ­¤é¡µé¢</div>;
      }

      return <Component {...props} />;
    };
  };
}

export default withAuth;
```

```javascript
// decorators/withLoading.jsx - åŠ è½½çŠ¶æ€è£…é¥°å™¨
function withLoading(fetchDataFn) {
  return function(Component) {
    return function WithLoadingComponent(props) {
      const [data, setData] = React.useState(null);
      const [loading, setLoading] = React.useState(true);

      React.useEffect(() => {
        setLoading(true);
        fetchDataFn(props)
          .then(setData)
          .finally(() => setLoading(false));
      }, [props.userId]); // æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´ä¾èµ–

      if (loading) {
        return <div className="loading">åŠ è½½ä¸­...</div>;
      }

      return <Component {...props} data={data} />;
    };
  };
}

export default withLoading;
```

```javascript
// decorators/withErrorBoundary.jsx - é”™è¯¯è¾¹ç•Œè£…é¥°å™¨
function withErrorBoundary(Component) {
  return class WithErrorBoundary extends React.Component {
    constructor(props) {
      super(props);
      this.state = { hasError: false, error: null };
    }

    static getDerivedStateFromError(error) {
      return { hasError: true, error };
    }

    componentDidCatch(error, errorInfo) {
      console.error('ç»„ä»¶é”™è¯¯:', error, errorInfo);
    }

    render() {
      if (this.state.hasError) {
        return (
          <div className="error">
            <h2>å‡ºé”™äº†</h2>
            <p>{this.state.error?.message}</p>
          </div>
        );
      }

      return <Component {...this.props} />;
    }
  };
}

export default withErrorBoundary;
```

```javascript
// decorators/withLogger.jsx - æ—¥å¿—è£…é¥°å™¨
function withLogger(componentName) {
  return function(Component) {
    return function WithLoggerComponent(props) {
      React.useEffect(() => {
        console.log(`[${componentName}] ç»„ä»¶æŒ‚è½½`, props);
        return () => {
          console.log(`[${componentName}] ç»„ä»¶å¸è½½`);
        };
      }, []);

      React.useEffect(() => {
        console.log(`[${componentName}] Props æ›´æ–°`, props);
      }, [props]);

      return <Component {...props} />;
    };
  };
}

export default withLogger;
```

```javascript
// decorators/withPerformance.jsx - æ€§èƒ½ç›‘æ§è£…é¥°å™¨
function withPerformance(componentName) {
  return function(Component) {
    return function WithPerformanceComponent(props) {
      const renderStartTime = React.useRef(performance.now());

      React.useEffect(() => {
        const renderEndTime = performance.now();
        const renderTime = renderEndTime - renderStartTime.current;
        console.log(`[æ€§èƒ½] ${componentName} æ¸²æŸ“è€—æ—¶: ${renderTime.toFixed(2)}ms`);
      });

      return <Component {...props} />;
    };
  };
}

export default withPerformance;
```

```javascript
// UserProfileContainer.jsx - ç»„åˆä½¿ç”¨è£…é¥°å™¨
import UserProfile from './UserProfile';
import withAuth from './decorators/withAuth';
import withLoading from './decorators/withLoading';
import withErrorBoundary from './decorators/withErrorBoundary';
import withLogger from './decorators/withLogger';
import withPerformance from './decorators/withPerformance';
import { fetchUser } from './api';

// ç»„åˆå¤šä¸ªè£…é¥°å™¨
const EnhancedUserProfile = withErrorBoundary(
  withAuth('user:read')(
    withLoading(({ userId }) => fetchUser(userId))(
      withLogger('UserProfile')(
        withPerformance('UserProfile')(
          UserProfile
        )
      )
    )
  )
);

// ä½¿ç”¨
function App() {
  return <EnhancedUserProfile userId={1} />;
}
```

**æ•ˆæœ**ï¼š
- âœ… å•ä¸€èŒè´£ï¼šæ¯ä¸ªè£…é¥°å™¨åªåšä¸€ä»¶äº‹
- âœ… é«˜åº¦å¤ç”¨ï¼šè£…é¥°å™¨å¯ä»¥ç”¨äºä»»ä½•ç»„ä»¶
- âœ… æ˜“äºæµ‹è¯•ï¼šå¯ä»¥ç‹¬ç«‹æµ‹è¯•ä¸šåŠ¡ç»„ä»¶å’Œè£…é¥°å™¨
- âœ… çµæ´»ç»„åˆï¼šå¯ä»¥è‡ªç”±ç»„åˆä¸åŒçš„è£…é¥°å™¨

---

### ğŸ¯ ä½¿ç”¨ Hooks å®ç°è£…é¥°å™¨æ¨¡å¼

åœ¨ç°ä»£ React ä¸­ï¼Œæˆ‘ä»¬æ›´å€¾å‘äºä½¿ç”¨ Hooksï¼š

```javascript
// hooks/useAuth.js
function useAuth(requiredPermission) {
  const [hasPermission, setHasPermission] = React.useState(null);
  const [loading, setLoading] = React.useState(true);

  React.useEffect(() => {
    checkUserPermission(requiredPermission)
      .then(setHasPermission)
      .finally(() => setLoading(false));
  }, [requiredPermission]);

  return { hasPermission, loading };
}

export default useAuth;
```

```javascript
// hooks/useDataFetching.js
function useDataFetching(fetchFn, deps = []) {
  const [data, setData] = React.useState(null);
  const [loading, setLoading] = React.useState(true);
  const [error, setError] = React.useState(null);

  React.useEffect(() => {
    setLoading(true);
    setError(null);

    fetchFn()
      .then(setData)
      .catch(setError)
      .finally(() => setLoading(false));
  }, deps);

  return { data, loading, error };
}

export default useDataFetching;
```

```javascript
// hooks/useLogger.js
function useLogger(componentName, data) {
  React.useEffect(() => {
    console.log(`[${componentName}] æ•°æ®æ›´æ–°:`, data);
  }, [componentName, data]);
}

export default useLogger;
```

```javascript
// UserProfile.jsx - ä½¿ç”¨ Hooks ç»„åˆåŠŸèƒ½
import useAuth from './hooks/useAuth';
import useDataFetching from './hooks/useDataFetching';
import useLogger from './hooks/useLogger';
import { fetchUser } from './api';

function UserProfile({ userId }) {
  // æƒé™æ£€æŸ¥
  const { hasPermission, loading: authLoading } = useAuth('user:read');

  // æ•°æ®åŠ è½½
  const { data: user, loading: dataLoading, error } = useDataFetching(
    () => fetchUser(userId),
    [userId]
  );

  // æ—¥å¿—è®°å½•
  useLogger('UserProfile', user);

  if (authLoading) {
    return <div>æ£€æŸ¥æƒé™ä¸­...</div>;
  }

  if (!hasPermission) {
    return <div>æ‚¨æ²¡æœ‰æƒé™æŸ¥çœ‹æ­¤é¡µé¢</div>;
  }

  if (error) {
    return <div>é”™è¯¯: {error.message}</div>;
  }

  if (dataLoading) {
    return <div>åŠ è½½ä¸­...</div>;
  }

  return (
    <div className="user-profile">
      <h1>{user.name}</h1>
      <p>é‚®ç®±: {user.email}</p>
      <p>å¹´é¾„: {user.age}</p>
    </div>
  );
}
```

---

### ğŸ—ï¸ çœŸå®ä¸šåŠ¡åœºæ™¯

#### åœºæ™¯1ï¼šAPI è¯·æ±‚è£…é¥°å™¨ï¼ˆä¸­é—´ä»¶ï¼‰

```javascript
// api/middleware/authMiddleware.js - è®¤è¯ä¸­é—´ä»¶
function authMiddleware(request) {
  return function decoratedRequest(config) {
    const token = localStorage.getItem('token');
    if (token) {
      config.headers = {
        ...config.headers,
        Authorization: `Bearer ${token}`,
      };
    }
    return request(config);
  };
}

// api/middleware/loggerMiddleware.js - æ—¥å¿—ä¸­é—´ä»¶
function loggerMiddleware(request) {
  return function decoratedRequest(config) {
    console.log('API è¯·æ±‚:', config.url, config);
    const startTime = Date.now();

    return request(config).then(
      response => {
        const duration = Date.now() - startTime;
        console.log(`API å“åº”: ${config.url} (${duration}ms)`, response);
        return response;
      },
      error => {
        const duration = Date.now() - startTime;
        console.error(`API é”™è¯¯: ${config.url} (${duration}ms)`, error);
        throw error;
      }
    );
  };
}

// api/middleware/retryMiddleware.js - é‡è¯•ä¸­é—´ä»¶
function retryMiddleware(maxRetries = 3) {
  return function(request) {
    return function decoratedRequest(config) {
      let retries = 0;

      const attemptRequest = () => {
        return request(config).catch(error => {
          if (retries < maxRetries && isRetryableError(error)) {
            retries++;
            console.log(`é‡è¯•è¯·æ±‚ (${retries}/${maxRetries}):`, config.url);
            return new Promise(resolve => setTimeout(resolve, 1000 * retries))
              .then(attemptRequest);
          }
          throw error;
        });
      };

      return attemptRequest();
    };
  };
}

function isRetryableError(error) {
  return error.response?.status >= 500 || error.code === 'ECONNABORTED';
}

// api/middleware/cacheMiddleware.js - ç¼“å­˜ä¸­é—´ä»¶
function cacheMiddleware(request) {
  const cache = new Map();

  return function decoratedRequest(config) {
    if (config.method?.toLowerCase() !== 'get') {
      return request(config);
    }

    const cacheKey = `${config.url}?${JSON.stringify(config.params)}`;

    if (cache.has(cacheKey)) {
      console.log('ä»ç¼“å­˜è¿”å›:', cacheKey);
      return Promise.resolve(cache.get(cacheKey));
    }

    return request(config).then(response => {
      cache.set(cacheKey, response);
      return response;
    });
  };
}

// api/client.js - ç»„åˆä¸­é—´ä»¶
function createApiClient() {
  // åŸºç¡€è¯·æ±‚å‡½æ•°
  const baseRequest = (config) => {
    return fetch(config.url, {
      method: config.method || 'GET',
      headers: config.headers,
      body: config.data ? JSON.stringify(config.data) : undefined,
    }).then(response => response.json());
  };

  // å±‚å±‚è£…é¥°
  let request = baseRequest;
  request = authMiddleware(request);
  request = loggerMiddleware(request);
  request = retryMiddleware(3)(request);
  request = cacheMiddleware(request);

  return {
    get: (url, config = {}) => request({ ...config, url, method: 'GET' }),
    post: (url, data, config = {}) => request({ ...config, url, method: 'POST', data }),
  };
}

export default createApiClient();
```

```javascript
// ä½¿ç”¨
import apiClient from './api/client';

function UserList() {
  const [users, setUsers] = React.useState([]);

  React.useEffect(() => {
    // è‡ªåŠ¨å¸¦ä¸Šè®¤è¯ã€æ—¥å¿—ã€é‡è¯•ã€ç¼“å­˜åŠŸèƒ½
    apiClient.get('/users').then(setUsers);
  }, []);

  return (
    <ul>
      {users.map(user => (
        <li key={user.id}>{user.name}</li>
      ))}
    </ul>
  );
}
```

#### åœºæ™¯2ï¼šè¡¨å•éªŒè¯è£…é¥°å™¨

```javascript
// decorators/withFormValidation.jsx
function withFormValidation(validationRules) {
  return function(Component) {
    return function WithValidationComponent(props) {
      const [values, setValues] = React.useState({});
      const [errors, setErrors] = React.useState({});
      const [touched, setTouched] = React.useState({});

      const validate = (fieldName, value) => {
        const rules = validationRules[fieldName];
        if (!rules) return '';

        for (const rule of rules) {
          const error = rule(value, values);
          if (error) return error;
        }
        return '';
      };

      const handleChange = (fieldName, value) => {
        setValues(prev => ({ ...prev, [fieldName]: value }));

        if (touched[fieldName]) {
          const error = validate(fieldName, value);
          setErrors(prev => ({ ...prev, [fieldName]: error }));
        }
      };

      const handleBlur = (fieldName) => {
        setTouched(prev => ({ ...prev, [fieldName]: true }));
        const error = validate(fieldName, values[fieldName]);
        setErrors(prev => ({ ...prev, [fieldName]: error }));
      };

      const handleSubmit = (e) => {
        e.preventDefault();

        // éªŒè¯æ‰€æœ‰å­—æ®µ
        const newErrors = {};
        Object.keys(validationRules).forEach(fieldName => {
          const error = validate(fieldName, values[fieldName]);
          if (error) newErrors[fieldName] = error;
        });

        setErrors(newErrors);
        setTouched(
          Object.keys(validationRules).reduce((acc, key) => {
            acc[key] = true;
            return acc;
          }, {})
        );

        if (Object.keys(newErrors).length === 0) {
          props.onSubmit?.(values);
        }
      };

      return (
        <Component
          {...props}
          values={values}
          errors={errors}
          touched={touched}
          onChange={handleChange}
          onBlur={handleBlur}
          onSubmit={handleSubmit}
        />
      );
    };
  };
}

// éªŒè¯è§„åˆ™
const required = (message = 'æ­¤å­—æ®µä¸ºå¿…å¡«') => (value) => {
  return !value ? message : '';
};

const minLength = (length, message) => (value) => {
  return value && value.length < length ? message || `æœ€å°‘${length}ä¸ªå­—ç¬¦` : '';
};

const email = (message = 'è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±') => (value) => {
  const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  return value && !regex.test(value) ? message : '';
};

export { withFormValidation, required, minLength, email };
```

```javascript
// LoginForm.jsx
import { withFormValidation, required, minLength, email } from './decorators/withFormValidation';

function LoginForm({ values, errors, touched, onChange, onBlur, onSubmit }) {
  return (
    <form onSubmit={onSubmit}>
      <div>
        <input
          type="email"
          placeholder="é‚®ç®±"
          value={values.email || ''}
          onChange={(e) => onChange('email', e.target.value)}
          onBlur={() => onBlur('email')}
        />
        {touched.email && errors.email && (
          <span className="error">{errors.email}</span>
        )}
      </div>

      <div>
        <input
          type="password"
          placeholder="å¯†ç "
          value={values.password || ''}
          onChange={(e) => onChange('password', e.target.value)}
          onBlur={() => onBlur('password')}
        />
        {touched.password && errors.password && (
          <span className="error">{errors.password}</span>
        )}
      </div>

      <button type="submit">ç™»å½•</button>
    </form>
  );
}

// è£…é¥°è¡¨å•
const EnhancedLoginForm = withFormValidation({
  email: [required('é‚®ç®±ä¸èƒ½ä¸ºç©º'), email()],
  password: [required('å¯†ç ä¸èƒ½ä¸ºç©º'), minLength(6, 'å¯†ç è‡³å°‘6ä¸ªå­—ç¬¦')],
})(LoginForm);

// ä½¿ç”¨
function App() {
  const handleSubmit = (values) => {
    console.log('æäº¤è¡¨å•:', values);
    // è°ƒç”¨ç™»å½• API
  };

  return <EnhancedLoginForm onSubmit={handleSubmit} />;
}
```

---

### ğŸ¨ åœ¨ä¸»æµæ¡†æ¶ä¸­çš„åº”ç”¨

#### React - é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰

```javascript
// React Router çš„ withRouter
import { withRouter } from 'react-router-dom';

function MyComponent({ history, location, match }) {
  return <div>å½“å‰è·¯å¾„: {location.pathname}</div>;
}

export default withRouter(MyComponent);

// Redux çš„ connect
import { connect } from 'react-redux';

function UserProfile({ user, loadUser }) {
  return <div>{user.name}</div>;
}

const mapStateToProps = state => ({
  user: state.user,
});

const mapDispatchToProps = {
  loadUser: loadUserAction,
};

export default connect(mapStateToProps, mapDispatchToProps)(UserProfile);
```

#### JavaScript Decorator è¯­æ³•

```javascript
// ä½¿ç”¨ @decorator è¯­æ³•ï¼ˆéœ€è¦ Babel æ”¯æŒï¼‰
function readonly(target, key, descriptor) {
  descriptor.writable = false;
  return descriptor;
}

function log(target, key, descriptor) {
  const original = descriptor.value;
  descriptor.value = function(...args) {
    console.log(`è°ƒç”¨ ${key}ï¼Œå‚æ•°:`, args);
    const result = original.apply(this, args);
    console.log(`${key} è¿”å›:`, result);
    return result;
  };
  return descriptor;
}

class User {
  @readonly
  name = 'John';

  @log
  sayHello(greeting) {
    return `${greeting}, ${this.name}`;
  }
}

const user = new User();
user.sayHello('Hi'); // è‡ªåŠ¨æ‰“å°æ—¥å¿—
// user.name = 'Jane'; // æŠ¥é”™ï¼Œåªè¯»å±æ€§
```

#### Express ä¸­é—´ä»¶ - è£…é¥°å™¨æ¨¡å¼çš„å…¸å‹åº”ç”¨

```javascript
const express = require('express');
const app = express();

// æ—¥å¿—ä¸­é—´ä»¶
function logger(req, res, next) {
  console.log(`${req.method} ${req.url}`);
  next();
}

// è®¤è¯ä¸­é—´ä»¶
function authenticate(req, res, next) {
  const token = req.headers.authorization;
  if (!token) {
    return res.status(401).json({ error: 'Unauthorized' });
  }
  // éªŒè¯ token
  next();
}

// ç»„åˆä½¿ç”¨ä¸­é—´ä»¶
app.use(logger);
app.use('/api', authenticate); // åªå¯¹ /api è·¯ç”±å¯ç”¨è®¤è¯

app.get('/api/users', (req, res) => {
  res.json({ users: [] });
});
```

---

### âš–ï¸ ä¼˜ç¼ºç‚¹åˆ†æ

#### âœ… ä¼˜ç‚¹

1. **å•ä¸€èŒè´£**ï¼šæ¯ä¸ªè£…é¥°å™¨åªåšä¸€ä»¶äº‹
2. **å¼€é—­åŸåˆ™**ï¼šå¯ä»¥åŠ¨æ€æ·»åŠ åŠŸèƒ½ï¼Œæ— éœ€ä¿®æ”¹åŸæœ‰ä»£ç 
3. **é«˜åº¦å¤ç”¨**ï¼šè£…é¥°å™¨å¯ä»¥åº”ç”¨äºå¤šä¸ªç»„ä»¶
4. **çµæ´»ç»„åˆ**ï¼šå¯ä»¥è‡ªç”±ç»„åˆä¸åŒçš„è£…é¥°å™¨
5. **æ˜“äºæµ‹è¯•**ï¼šå¯ä»¥ç‹¬ç«‹æµ‹è¯•è£…é¥°å™¨å’Œæ ¸å¿ƒç»„ä»¶

#### âŒ ç¼ºç‚¹

1. **å¤šå±‚åŒ…è£…**ï¼šè¿‡å¤šçš„è£…é¥°å™¨ä¼šå¯¼è‡´å±‚æ¬¡è¿‡æ·±
2. **è°ƒè¯•å›°éš¾**ï¼šé”™è¯¯å †æ ˆå¯èƒ½å¾ˆé•¿ï¼Œéš¾ä»¥å®šä½é—®é¢˜
3. **é¡ºåºæ•æ„Ÿ**ï¼šè£…é¥°å™¨çš„é¡ºåºå¯èƒ½å½±å“ç»“æœ
4. **Props ä¼ é€’**ï¼šHOC éœ€è¦æ‰‹åŠ¨ä¼ é€’ props

---

### ğŸ“‹ ä½•æ—¶ä½¿ç”¨è£…é¥°å™¨æ¨¡å¼

#### âœ… é€‚åˆä½¿ç”¨çš„åœºæ™¯

- éœ€è¦åŠ¨æ€æ·»åŠ åŠŸèƒ½ï¼ˆæƒé™ã€æ—¥å¿—ã€æ€§èƒ½ç›‘æ§ï¼‰
- å¤šä¸ªç»„ä»¶éœ€è¦ç›¸åŒçš„åŠŸèƒ½å¢å¼º
- ä¸­é—´ä»¶ç³»ç»Ÿï¼ˆAPI è¯·æ±‚ã€Express è·¯ç”±ï¼‰
- éœ€è¦ç»„åˆå¤šä¸ªç‹¬ç«‹åŠŸèƒ½
- ä¸æƒ³ä¿®æ”¹åŸæœ‰ä»£ç 

#### âŒ ä¸é€‚åˆä½¿ç”¨çš„åœºæ™¯

- åªåœ¨ä¸€ä¸ªåœ°æ–¹ä½¿ç”¨çš„åŠŸèƒ½
- è£…é¥°å™¨ä¹‹é—´æœ‰å¤æ‚çš„ä¾èµ–å…³ç³»
- éœ€è¦é¢‘ç¹ä¿®æ”¹æ ¸å¿ƒé€»è¾‘
- æ€§èƒ½æ•æ„Ÿçš„åœºæ™¯ï¼ˆè£…é¥°å™¨æœ‰ä¸€å®šå¼€é”€ï¼‰

---

### ğŸ“ è£…é¥°å™¨æ¨¡å¼æœ€ä½³å®è·µ

```javascript
// âœ… å¥½çš„å®è·µï¼šè£…é¥°å™¨èŒè´£å•ä¸€ã€å¯ç»„åˆ
const withAuth = (permission) => (Component) => { /* ... */ };
const withLoading = (fetchFn) => (Component) => { /* ... */ };
const withErrorBoundary = (Component) => { /* ... */ };

// ç»„åˆä½¿ç”¨
const Enhanced = withAuth('user:read')(
  withLoading(fetchUser)(
    withErrorBoundary(UserProfile)
  )
);

// âŒ åçš„å®è·µï¼šä¸€ä¸ªè£…é¥°å™¨åšå¤ªå¤šäº‹
const withEverything = (Component) => {
  // è®¤è¯ã€åŠ è½½ã€é”™è¯¯å¤„ç†ã€æ—¥å¿—å…¨éƒ¨æ··åœ¨ä¸€èµ·
  // éš¾ä»¥å¤ç”¨å’Œæµ‹è¯•
};

// âœ… ä½¿ç”¨ compose å‡½æ•°ä¼˜åŒ–ç»„åˆ
function compose(...fns) {
  return fns.reduce((a, b) => (...args) => a(b(...args)));
}

const enhance = compose(
  withAuth('user:read'),
  withLoading(fetchUser),
  withErrorBoundary
);

const Enhanced = enhance(UserProfile);
```

---

## ä»£ç†æ¨¡å¼

### ğŸ’¡ æ¨¡å¼å®šä¹‰
ä»£ç†æ¨¡å¼ï¼ˆProxy Patternï¼‰ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ï¼Œä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚ä»£ç†å¯¹è±¡åœ¨å®¢æˆ·ç«¯å’Œç›®æ ‡å¯¹è±¡ä¹‹é—´èµ·åˆ°ä¸­ä»‹ä½œç”¨ã€‚

### ğŸ¤” ä¸ºä»€ä¹ˆéœ€è¦ä»£ç†æ¨¡å¼ï¼Ÿ

#### é—®é¢˜åœºæ™¯ï¼šæ§åˆ¶å¯¹è±¡è®¿é—®ã€æ‡’åŠ è½½ã€ç¼“å­˜ã€æƒé™æ§åˆ¶

#### âŒ ä¸ä½¿ç”¨ä»£ç†æ¨¡å¼çš„ç—›ç‚¹

```javascript
// ImageGallery.jsx - ç›´æ¥åŠ è½½æ‰€æœ‰å›¾ç‰‡
function ImageGallery({ images }) {
  return (
    <div className="gallery">
      {images.map(image => (
        <div key={image.id} className="image-item">
          {/* æ‰€æœ‰å›¾ç‰‡ç«‹å³åŠ è½½ï¼Œå³ä½¿ä¸åœ¨å¯è§†åŒºåŸŸ */}
          <img
            src={image.largeUrl} // åŠ è½½å¤§å›¾
            alt={image.title}
            style={{ width: '100%', height: 'auto' }}
          />
          <p>{image.title}</p>
        </div>
      ))}
    </div>
  );
}

// ä½¿ç”¨
function App() {
  const images = [
    { id: 1, title: 'å›¾ç‰‡1', largeUrl: 'large1.jpg' },
    { id: 2, title: 'å›¾ç‰‡2', largeUrl: 'large2.jpg' },
    // ... 100 å¼ å›¾ç‰‡
  ];

  return <ImageGallery images={images} />;
}
```

**é—®é¢˜**ï¼š
- é¡µé¢åŠ è½½æ…¢ï¼šæ‰€æœ‰å›¾ç‰‡ç«‹å³åŠ è½½ï¼Œå³ä½¿ä¸åœ¨å¯è§†åŒºåŸŸ
- æµªè´¹å¸¦å®½ï¼šç”¨æˆ·å¯èƒ½ä¸ä¼šæµè§ˆåˆ°æ‰€æœ‰å›¾ç‰‡
- å†…å­˜å ç”¨é«˜ï¼š100 å¼ å¤§å›¾åŒæ—¶åŠ è½½

---

#### âœ… ä½¿ç”¨ä»£ç†æ¨¡å¼è§£å†³ï¼ˆæ‡’åŠ è½½å›¾ç‰‡ï¼‰

```javascript
// components/LazyImage.jsx - å›¾ç‰‡ä»£ç†ç»„ä»¶
function LazyImage({ src, thumbnail, alt, ...props }) {
  const [imageSrc, setImageSrc] = React.useState(thumbnail || null);
  const [isLoading, setIsLoading] = React.useState(true);
  const imgRef = React.useRef();

  React.useEffect(() => {
    // ä½¿ç”¨ Intersection Observer ç›‘å¬å›¾ç‰‡æ˜¯å¦è¿›å…¥è§†å£
    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            // å›¾ç‰‡è¿›å…¥è§†å£ï¼Œå¼€å§‹åŠ è½½çœŸå®å›¾ç‰‡
            loadImage(src);
            observer.unobserve(entry.target);
          }
        });
      },
      {
        rootMargin: '50px', // æå‰ 50px å¼€å§‹åŠ è½½
      }
    );

    if (imgRef.current) {
      observer.observe(imgRef.current);
    }

    return () => {
      if (imgRef.current) {
        observer.unobserve(imgRef.current);
      }
    };
  }, [src]);

  const loadImage = (imageSrc) => {
    const img = new Image();
    img.src = imageSrc;
    img.onload = () => {
      setImageSrc(imageSrc);
      setIsLoading(false);
    };
    img.onerror = () => {
      setIsLoading(false);
      console.error('å›¾ç‰‡åŠ è½½å¤±è´¥:', imageSrc);
    };
  };

  return (
    <div ref={imgRef} className="lazy-image-container">
      <img
        src={imageSrc}
        alt={alt}
        className={isLoading ? 'loading' : 'loaded'}
        {...props}
      />
      {isLoading && <div className="placeholder">åŠ è½½ä¸­...</div>}
    </div>
  );
}

export default LazyImage;
```

```javascript
// ImageGallery.jsx - ä½¿ç”¨ä»£ç†ç»„ä»¶
import LazyImage from './components/LazyImage';

function ImageGallery({ images }) {
  return (
    <div className="gallery">
      {images.map(image => (
        <div key={image.id} className="image-item">
          {/* ä½¿ç”¨ä»£ç†ç»„ä»¶ï¼Œåªåœ¨éœ€è¦æ—¶åŠ è½½ */}
          <LazyImage
            src={image.largeUrl}
            thumbnail={image.thumbnailUrl}
            alt={image.title}
            style={{ width: '100%', height: 'auto' }}
          />
          <p>{image.title}</p>
        </div>
      ))}
    </div>
  );
}
```

**æ•ˆæœ**ï¼š
- âœ… æŒ‰éœ€åŠ è½½ï¼šåªåŠ è½½å¯è§†åŒºåŸŸçš„å›¾ç‰‡
- âœ… èŠ‚çœå¸¦å®½ï¼šç”¨æˆ·ä¸çœ‹çš„å›¾ç‰‡ä¸åŠ è½½
- âœ… æ€§èƒ½æå‡ï¼šé¡µé¢åŠ è½½æ›´å¿«
- âœ… ç”¨æˆ·ä½“éªŒï¼šå…ˆæ˜¾ç¤ºç¼©ç•¥å›¾ï¼Œå†åŠ è½½å¤§å›¾

---

### ğŸ¯ ES6 Proxy å®ç°å“åº”å¼æ•°æ®

```javascript
// reactive.js - ä½¿ç”¨ Proxy å®ç°å“åº”å¼
function reactive(target) {
  const handlers = {
    get(target, key, receiver) {
      console.log(`è¯»å–å±æ€§: ${key}`);

      // å¦‚æœå±æ€§å€¼æ˜¯å¯¹è±¡ï¼Œé€’å½’ä»£ç†
      const result = Reflect.get(target, key, receiver);
      if (typeof result === 'object' && result !== null) {
        return reactive(result);
      }

      return result;
    },

    set(target, key, value, receiver) {
      const oldValue = target[key];
      console.log(`è®¾ç½®å±æ€§: ${key}, æ—§å€¼: ${oldValue}, æ–°å€¼: ${value}`);

      const result = Reflect.set(target, key, value, receiver);

      // è§¦å‘æ›´æ–°
      if (oldValue !== value) {
        console.log(`å±æ€§ ${key} å‘ç”Ÿå˜åŒ–ï¼Œè§¦å‘æ›´æ–°`);
      }

      return result;
    },

    deleteProperty(target, key) {
      console.log(`åˆ é™¤å±æ€§: ${key}`);
      return Reflect.deleteProperty(target, key);
    },
  };

  return new Proxy(target, handlers);
}

// ä½¿ç”¨
const user = reactive({
  name: 'John',
  age: 25,
  address: {
    city: 'Beijing',
    street: 'xxx'
  }
});

user.name; // è¯»å–å±æ€§: name
user.name = 'Jane'; // è®¾ç½®å±æ€§: name, æ—§å€¼: John, æ–°å€¼: Jane
user.address.city; // è¯»å–å±æ€§: address -> è¯»å–å±æ€§: city
user.address.city = 'Shanghai'; // è§¦å‘æ›´æ–°
```

---

### ğŸ—ï¸ çœŸå®ä¸šåŠ¡åœºæ™¯

#### åœºæ™¯1ï¼šAPI ç¼“å­˜ä»£ç†

```javascript
// api/cacheProxy.js - API ç¼“å­˜ä»£ç†
class ApiCacheProxy {
  constructor(apiClient, options = {}) {
    this.apiClient = apiClient;
    this.cache = new Map();
    this.cacheTime = options.cacheTime || 5 * 60 * 1000; // é»˜è®¤ 5 åˆ†é’Ÿ
    this.maxCacheSize = options.maxCacheSize || 100; // æœ€å¤šç¼“å­˜ 100 ä¸ªè¯·æ±‚
  }

  _getCacheKey(url, params) {
    return `${url}?${JSON.stringify(params || {})}`;
  }

  _isExpired(cacheEntry) {
    return Date.now() - cacheEntry.timestamp > this.cacheTime;
  }

  _cleanupCache() {
    if (this.cache.size >= this.maxCacheSize) {
      // åˆ é™¤æœ€æ—§çš„ç¼“å­˜
      const firstKey = this.cache.keys().next().value;
      this.cache.delete(firstKey);
    }
  }

  async get(url, params, options = {}) {
    const cacheKey = this._getCacheKey(url, params);

    // æ£€æŸ¥ç¼“å­˜
    if (this.cache.has(cacheKey) && !options.forceRefresh) {
      const cacheEntry = this.cache.get(cacheKey);

      if (!this._isExpired(cacheEntry)) {
        console.log('ä»ç¼“å­˜è¿”å›:', url);
        return cacheEntry.data;
      } else {
        // ç¼“å­˜è¿‡æœŸï¼Œåˆ é™¤
        this.cache.delete(cacheKey);
      }
    }

    // å‘èµ·çœŸå®è¯·æ±‚
    console.log('ä» API è·å–:', url);
    const data = await this.apiClient.get(url, params);

    // å­˜å…¥ç¼“å­˜
    this._cleanupCache();
    this.cache.set(cacheKey, {
      data,
      timestamp: Date.now(),
    });

    return data;
  }

  async post(url, data, params) {
    // POST è¯·æ±‚ä¼šä½¿ç¼“å­˜å¤±æ•ˆ
    this.clearCache();
    return await this.apiClient.post(url, data, params);
  }

  clearCache() {
    console.log('æ¸…ç©ºç¼“å­˜');
    this.cache.clear();
  }

  getCacheStats() {
    return {
      size: this.cache.size,
      maxSize: this.maxCacheSize,
      entries: Array.from(this.cache.entries()).map(([key, value]) => ({
        key,
        timestamp: value.timestamp,
        age: Date.now() - value.timestamp,
      })),
    };
  }
}

export default ApiCacheProxy;
```

```javascript
// ä½¿ç”¨ç¼“å­˜ä»£ç†
import axios from 'axios';
import ApiCacheProxy from './api/cacheProxy';

const apiClient = axios.create({
  baseURL: 'https://api.example.com',
});

const cachedApi = new ApiCacheProxy(apiClient, {
  cacheTime: 10 * 60 * 1000, // 10 åˆ†é’Ÿ
  maxCacheSize: 50,
});

function UserList() {
  const [users, setUsers] = React.useState([]);

  React.useEffect(() => {
    // ç¬¬ä¸€æ¬¡ä» API è·å–
    cachedApi.get('/users').then(setUsers);

    // 5 ç§’åå†æ¬¡è¯·æ±‚ï¼Œä¼šä»ç¼“å­˜è¿”å›
    setTimeout(() => {
      cachedApi.get('/users').then(data => {
        console.log('ç¬¬äºŒæ¬¡è¯·æ±‚ï¼Œä»ç¼“å­˜è·å–');
      });
    }, 5000);
  }, []);

  return (
    <ul>
      {users.map(user => (
        <li key={user.id}>{user.name}</li>
      ))}
    </ul>
  );
}
```

#### åœºæ™¯2ï¼šæƒé™æ§åˆ¶ä»£ç†

```javascript
// security/PermissionProxy.js - æƒé™æ§åˆ¶ä»£ç†
class PermissionProxy {
  constructor(targetObject, userPermissions) {
    this.target = targetObject;
    this.permissions = userPermissions;

    return new Proxy(targetObject, {
      get: (target, prop) => {
        // æ£€æŸ¥æ–¹æ³•æƒé™
        const requiredPermission = target.getRequiredPermission?.(prop);

        if (requiredPermission && !this.hasPermission(requiredPermission)) {
          throw new Error(`æ²¡æœ‰æƒé™æ‰§è¡Œæ“ä½œ: ${prop}`);
        }

        const value = target[prop];

        // å¦‚æœæ˜¯å‡½æ•°ï¼Œè¿”å›ä»£ç†åçš„å‡½æ•°
        if (typeof value === 'function') {
          return (...args) => {
            console.log(`æ‰§è¡Œæ“ä½œ: ${prop}`);
            return value.apply(target, args);
          };
        }

        return value;
      },

      set: (target, prop, value) => {
        // æ£€æŸ¥å†™å…¥æƒé™
        if (!this.hasPermission('write')) {
          throw new Error('æ²¡æœ‰å†™å…¥æƒé™');
        }

        console.log(`è®¾ç½®å±æ€§: ${prop} = ${value}`);
        target[prop] = value;
        return true;
      },
    });
  }

  hasPermission(permission) {
    return this.permissions.includes(permission);
  }
}

// ä½¿ç”¨
class UserManager {
  constructor() {
    this.users = [];
  }

  getRequiredPermission(method) {
    const permissionMap = {
      getUsers: 'user:read',
      addUser: 'user:create',
      deleteUser: 'user:delete',
    };
    return permissionMap[method];
  }

  getUsers() {
    return this.users;
  }

  addUser(user) {
    this.users.push(user);
    return user;
  }

  deleteUser(userId) {
    this.users = this.users.filter(u => u.id !== userId);
  }
}

// åˆ›å»ºä»£ç†
const adminManager = new PermissionProxy(
  new UserManager(),
  ['user:read', 'user:create', 'user:delete'] // ç®¡ç†å‘˜æƒé™
);

const guestManager = new PermissionProxy(
  new UserManager(),
  ['user:read'] // æ¸¸å®¢åªæœ‰è¯»æƒé™
);

// ç®¡ç†å‘˜å¯ä»¥æ‰§è¡Œæ‰€æœ‰æ“ä½œ
adminManager.addUser({ id: 1, name: 'John' }); // âœ… æˆåŠŸ
adminManager.getUsers(); // âœ… æˆåŠŸ

// æ¸¸å®¢åªèƒ½è¯»å–
guestManager.getUsers(); // âœ… æˆåŠŸ
// guestManager.addUser({ id: 2, name: 'Jane' }); // âŒ æŠ›å‡ºé”™è¯¯ï¼šæ²¡æœ‰æƒé™
```

#### åœºæ™¯3ï¼šè™šæ‹Ÿä»£ç†ï¼ˆæ‡’åŠ è½½æ¨¡å—ï¼‰

```javascript
// modules/lazyModuleProxy.js - æ¨¡å—æ‡’åŠ è½½ä»£ç†
function createLazyModuleProxy(importFn) {
  let moduleCache = null;
  let loadingPromise = null;

  return new Proxy({}, {
    get(target, prop) {
      // å¦‚æœæ¨¡å—å·²åŠ è½½ï¼Œç›´æ¥è¿”å›
      if (moduleCache) {
        return moduleCache[prop];
      }

      // å¦‚æœæ­£åœ¨åŠ è½½ï¼Œç­‰å¾…åŠ è½½å®Œæˆ
      if (loadingPromise) {
        return async (...args) => {
          const module = await loadingPromise;
          return module[prop](...args);
        };
      }

      // å¼€å§‹åŠ è½½æ¨¡å—
      loadingPromise = importFn().then(module => {
        moduleCache = module;
        loadingPromise = null;
        return module;
      });

      // è¿”å›ä¸€ä¸ªå¼‚æ­¥å‡½æ•°
      return async (...args) => {
        const module = await loadingPromise;
        return module[prop](...args);
      };
    },
  });
}

// ä½¿ç”¨
const heavyModule = createLazyModuleProxy(() => import('./heavyModule'));

// ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶æ‰åŠ è½½æ¨¡å—
async function handleClick() {
  await heavyModule.doSomething(); // è§¦å‘æ¨¡å—åŠ è½½
}
```

---

### ğŸ¨ åœ¨ä¸»æµæ¡†æ¶ä¸­çš„åº”ç”¨

#### Vue 3 å“åº”å¼ç³»ç»Ÿ - Proxy çš„å…¸å‹åº”ç”¨

```javascript
// Vue 3 ä½¿ç”¨ Proxy å®ç°å“åº”å¼
import { reactive, effect } from 'vue';

const state = reactive({
  count: 0,
  user: {
    name: 'John',
  },
});

// è‡ªåŠ¨è¿½è¸ªä¾èµ–
effect(() => {
  console.log('count:', state.count);
});

state.count++; // è‡ªåŠ¨è§¦å‘ effectï¼Œæ‰“å° "count: 1"
```

#### Mobx - Proxy å®ç°çŠ¶æ€ç®¡ç†

```javascript
import { observable, autorun } from 'mobx';

const store = observable({
  count: 0,
  increment() {
    this.count++;
  },
});

autorun(() => {
  console.log('Count:', store.count);
});

store.increment(); // è‡ªåŠ¨è§¦å‘ autorun
```

#### Immer - Proxy å®ç°ä¸å¯å˜æ•°æ®

```javascript
import produce from 'immer';

const state = {
  users: [
    { id: 1, name: 'John' },
    { id: 2, name: 'Jane' },
  ],
};

const nextState = produce(state, draft => {
  // å¯ä»¥ç›´æ¥ä¿®æ”¹ draftï¼ŒImmer ä¼šè‡ªåŠ¨åˆ›å»ºæ–°å¯¹è±¡
  draft.users[0].name = 'John Doe';
  draft.users.push({ id: 3, name: 'Bob' });
});

console.log(state === nextState); // falseï¼Œåˆ›å»ºäº†æ–°å¯¹è±¡
console.log(state.users === nextState.users); // false
```

---

### âš–ï¸ ä¼˜ç¼ºç‚¹åˆ†æ

#### âœ… ä¼˜ç‚¹

1. **æ§åˆ¶è®¿é—®**ï¼šå¯ä»¥åœ¨è®¿é—®å¯¹è±¡å‰è¿›è¡Œæƒé™æ£€æŸ¥
2. **æ‡’åŠ è½½**ï¼šå»¶è¿Ÿåˆ›å»ºå¼€é”€å¤§çš„å¯¹è±¡
3. **ç¼“å­˜**ï¼šç¼“å­˜ç»“æœï¼Œæå‡æ€§èƒ½
4. **æ—¥å¿—è®°å½•**ï¼šè®°å½•å¯¹è±¡çš„è®¿é—®å’Œä¿®æ”¹
5. **è¿œç¨‹ä»£ç†**ï¼šéšè—å¯¹è±¡åœ¨ä¸åŒåœ°å€ç©ºé—´çš„äº‹å®

#### âŒ ç¼ºç‚¹

1. **å¢åŠ å¤æ‚åº¦**ï¼šå¼•å…¥é¢å¤–çš„ä»£ç†å±‚
2. **æ€§èƒ½å¼€é”€**ï¼šæ¯æ¬¡è®¿é—®éƒ½è¦ç»è¿‡ä»£ç†
3. **è°ƒè¯•å›°éš¾**ï¼šé”™è¯¯å †æ ˆå¯èƒ½ä¸ç›´è§‚

---

### ğŸ“‹ ä½•æ—¶ä½¿ç”¨ä»£ç†æ¨¡å¼

#### âœ… é€‚åˆä½¿ç”¨çš„åœºæ™¯

- æ‡’åŠ è½½ï¼ˆè™šæ‹Ÿä»£ç†ï¼‰ï¼šå»¶è¿Ÿåˆ›å»ºå¼€é”€å¤§çš„å¯¹è±¡
- æƒé™æ§åˆ¶ï¼ˆä¿æŠ¤ä»£ç†ï¼‰ï¼šæ§åˆ¶å¯¹å¯¹è±¡çš„è®¿é—®
- ç¼“å­˜ï¼ˆæ™ºèƒ½ä»£ç†ï¼‰ï¼šç¼“å­˜ç»“æœï¼Œé¿å…é‡å¤è®¡ç®—
- è¿œç¨‹ä»£ç†ï¼šè®¿é—®è¿œç¨‹å¯¹è±¡
- æ—¥å¿—è®°å½•ï¼šè®°å½•å¯¹è±¡è®¿é—®

#### âŒ ä¸é€‚åˆä½¿ç”¨çš„åœºæ™¯

- ç®€å•å¯¹è±¡ï¼Œä¸éœ€è¦é¢å¤–æ§åˆ¶
- æ€§èƒ½æ•æ„Ÿçš„åœºæ™¯
- ä»£ç†é€»è¾‘æ¯”ç›®æ ‡å¯¹è±¡è¿˜å¤æ‚

---

## é€‚é…å™¨æ¨¡å¼

### ğŸ’¡ æ¨¡å¼å®šä¹‰
é€‚é…å™¨æ¨¡å¼ï¼ˆAdapter Patternï¼‰å°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·ç«¯æœŸæœ›çš„å¦ä¸€ä¸ªæ¥å£ï¼Œä½¿å¾—åŸæœ¬æ¥å£ä¸å…¼å®¹çš„ç±»å¯ä»¥ä¸€èµ·å·¥ä½œã€‚

### ğŸ¤” ä¸ºä»€ä¹ˆéœ€è¦é€‚é…å™¨æ¨¡å¼ï¼Ÿ

#### é—®é¢˜åœºæ™¯ï¼šæ¥å£ä¸å…¼å®¹ã€ç¬¬ä¸‰æ–¹åº“è¿ç§»ã€æ•°æ®æ ¼å¼è½¬æ¢

å‡è®¾ä½ çš„é¡¹ç›®æœ€åˆä½¿ç”¨ Axiosï¼Œç°åœ¨è¦è¿ç§»åˆ° Fetch APIï¼š

#### âŒ ä¸ä½¿ç”¨é€‚é…å™¨æ¨¡å¼çš„ç—›ç‚¹

```javascript
// åŸæ¥çš„ä»£ç ä½¿ç”¨ Axios
import axios from 'axios';

function UserList() {
  const [users, setUsers] = React.useState([]);

  React.useEffect(() => {
    axios.get('/api/users')
      .then(response => setUsers(response.data))
      .catch(error => console.error(error));
  }, []);

  return <ul>{users.map(u => <li key={u.id}>{u.name}</li>)}</ul>;
}

function ProductList() {
  const [products, setProducts] = React.useState([]);

  React.useEffect(() => {
    axios.get('/api/products')
      .then(response => setProducts(response.data))
      .catch(error => console.error(error));
  }, []);

  return <ul>{products.map(p => <li key={p.id}>{p.name}</li>)}</ul>;
}

// ... 100 ä¸ªç»„ä»¶éƒ½ä½¿ç”¨äº† axios.get
```

**ç°åœ¨éœ€è¦è¿ç§»åˆ° Fetch**ï¼š

```javascript
// éœ€è¦é€ä¸ªä¿®æ”¹æ‰€æœ‰ç»„ä»¶ ğŸ˜±
function UserList() {
  const [users, setUsers] = React.useState([]);

  React.useEffect(() => {
    fetch('/api/users')
      .then(response => response.json()) // ä¸åŒï¼
      .then(data => setUsers(data)) // ä¸åŒï¼
      .catch(error => console.error(error));
  }, []);

  return <ul>{users.map(u => <li key={u.id}>{u.name}</li>)}</ul>;
}

// éœ€è¦ä¿®æ”¹æ‰€æœ‰ 100 ä¸ªç»„ä»¶... ğŸ˜­
```

**é—®é¢˜**ï¼š
- ä¿®æ”¹æˆæœ¬é«˜ï¼šéœ€è¦ä¿®æ”¹æ‰€æœ‰ä½¿ç”¨ Axios çš„åœ°æ–¹
- å®¹æ˜“å‡ºé”™ï¼šå¯èƒ½æ¼æ‰æŸäº›åœ°æ–¹
- API ä¸ä¸€è‡´ï¼šAxios å’Œ Fetch çš„è¿”å›å€¼ç»“æ„ä¸åŒ

---

#### âœ… ä½¿ç”¨é€‚é…å™¨æ¨¡å¼è§£å†³

```javascript
// api/httpAdapter.js - HTTP å®¢æˆ·ç«¯é€‚é…å™¨
class HttpAdapter {
  constructor(client) {
    this.client = client;
  }

  async get(url, config = {}) {
    return this.request({ ...config, url, method: 'GET' });
  }

  async post(url, data, config = {}) {
    return this.request({ ...config, url, method: 'POST', data });
  }

  async put(url, data, config = {}) {
    return this.request({ ...config, url, method: 'PUT', data });
  }

  async delete(url, config = {}) {
    return this.request({ ...config, url, method: 'DELETE' });
  }

  async request(config) {
    throw new Error('Subclass must implement request method');
  }
}

// api/axiosAdapter.js - Axios é€‚é…å™¨
import axios from 'axios';

class AxiosAdapter extends HttpAdapter {
  async request(config) {
    try {
      const response = await axios({
        url: config.url,
        method: config.method,
        data: config.data,
        params: config.params,
        headers: config.headers,
      });

      // ç»Ÿä¸€è¿”å›æ ¼å¼
      return {
        data: response.data,
        status: response.status,
        headers: response.headers,
      };
    } catch (error) {
      throw {
        message: error.message,
        status: error.response?.status,
        data: error.response?.data,
      };
    }
  }
}

// api/fetchAdapter.js - Fetch é€‚é…å™¨
class FetchAdapter extends HttpAdapter {
  async request(config) {
    try {
      const response = await fetch(config.url, {
        method: config.method,
        headers: {
          'Content-Type': 'application/json',
          ...config.headers,
        },
        body: config.data ? JSON.stringify(config.data) : undefined,
      });

      const data = await response.json();

      if (!response.ok) {
        throw {
          message: `HTTP ${response.status}`,
          status: response.status,
          data,
        };
      }

      // ç»Ÿä¸€è¿”å›æ ¼å¼ï¼ˆä¸ Axios é€‚é…å™¨ç›¸åŒï¼‰
      return {
        data,
        status: response.status,
        headers: response.headers,
      };
    } catch (error) {
      throw {
        message: error.message,
        status: error.status,
        data: error.data,
      };
    }
  }
}

export { HttpAdapter, AxiosAdapter, FetchAdapter };
```

```javascript
// api/client.js - ä½¿ç”¨é€‚é…å™¨
import { AxiosAdapter, FetchAdapter } from './httpAdapter';

// å¯ä»¥è½»æ¾åˆ‡æ¢å®ç°
// const httpClient = new AxiosAdapter();
const httpClient = new FetchAdapter();

export default httpClient;
```

```javascript
// ç»„ä»¶ä»£ç æ— éœ€ä¿®æ”¹ï¼
import httpClient from './api/client';

function UserList() {
  const [users, setUsers] = React.useState([]);

  React.useEffect(() => {
    // æ— è®ºåº•å±‚æ˜¯ Axios è¿˜æ˜¯ Fetchï¼Œä»£ç éƒ½ä¸ç”¨æ”¹
    httpClient.get('/api/users')
      .then(response => setUsers(response.data))
      .catch(error => console.error(error));
  }, []);

  return <ul>{users.map(u => <li key={u.id}>{u.name}</li>)}</ul>;
}
```

**æ•ˆæœ**ï¼š
- âœ… ç»Ÿä¸€æ¥å£ï¼šæ‰€æœ‰ HTTP å®¢æˆ·ç«¯ä½¿ç”¨ç›¸åŒæ¥å£
- âœ… æ˜“äºåˆ‡æ¢ï¼šä¿®æ”¹ä¸€è¡Œä»£ç å³å¯åˆ‡æ¢å®ç°
- âœ… é›¶æ”¹åŠ¨ï¼šç»„ä»¶ä»£ç æ— éœ€ä¿®æ”¹
- âœ… æ˜“äºæ‰©å±•ï¼šå¯ä»¥è½»æ¾æ·»åŠ æ–°çš„é€‚é…å™¨

---

### ğŸ—ï¸ çœŸå®ä¸šåŠ¡åœºæ™¯

#### åœºæ™¯1ï¼šLocalStorage é€‚é…å™¨ï¼ˆå…¼å®¹ä¸åŒå­˜å‚¨æ–¹æ¡ˆï¼‰

```javascript
// storage/StorageAdapter.js
class StorageAdapter {
  get(key) {
    throw new Error('Subclass must implement get method');
  }

  set(key, value) {
    throw new Error('Subclass must implement set method');
  }

  remove(key) {
    throw new Error('Subclass must implement remove method');
  }

  clear() {
    throw new Error('Subclass must implement clear method');
  }
}

// storage/LocalStorageAdapter.js
class LocalStorageAdapter extends StorageAdapter {
  get(key) {
    try {
      const value = localStorage.getItem(key);
      return value ? JSON.parse(value) : null;
    } catch (error) {
      console.error('LocalStorage get error:', error);
      return null;
    }
  }

  set(key, value) {
    try {
      localStorage.setItem(key, JSON.stringify(value));
      return true;
    } catch (error) {
      console.error('LocalStorage set error:', error);
      return false;
    }
  }

  remove(key) {
    localStorage.removeItem(key);
  }

  clear() {
    localStorage.clear();
  }
}

// storage/SessionStorageAdapter.js
class SessionStorageAdapter extends StorageAdapter {
  get(key) {
    try {
      const value = sessionStorage.getItem(key);
      return value ? JSON.parse(value) : null;
    } catch (error) {
      console.error('SessionStorage get error:', error);
      return null;
    }
  }

  set(key, value) {
    try {
      sessionStorage.setItem(key, JSON.stringify(value));
      return true;
    } catch (error) {
      console.error('SessionStorage set error:', error);
      return false;
    }
  }

  remove(key) {
    sessionStorage.removeItem(key);
  }

  clear() {
    sessionStorage.clear();
  }
}

// storage/MemoryStorageAdapter.js - å†…å­˜å­˜å‚¨ï¼ˆç”¨äºæµ‹è¯•æˆ–ä¸æ”¯æŒ localStorage çš„ç¯å¢ƒï¼‰
class MemoryStorageAdapter extends StorageAdapter {
  constructor() {
    super();
    this.store = new Map();
  }

  get(key) {
    return this.store.get(key) || null;
  }

  set(key, value) {
    this.store.set(key, value);
    return true;
  }

  remove(key) {
    this.store.delete(key);
  }

  clear() {
    this.store.clear();
  }
}

// storage/CookieStorageAdapter.js - Cookie å­˜å‚¨é€‚é…å™¨
class CookieStorageAdapter extends StorageAdapter {
  get(key) {
    const name = key + '=';
    const decodedCookie = decodeURIComponent(document.cookie);
    const cookies = decodedCookie.split(';');

    for (let cookie of cookies) {
      cookie = cookie.trim();
      if (cookie.indexOf(name) === 0) {
        const value = cookie.substring(name.length);
        try {
          return JSON.parse(value);
        } catch {
          return value;
        }
      }
    }
    return null;
  }

  set(key, value, days = 365) {
    const date = new Date();
    date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
    const expires = 'expires=' + date.toUTCString();
    const stringValue = typeof value === 'string' ? value : JSON.stringify(value);
    document.cookie = `${key}=${stringValue};${expires};path=/`;
    return true;
  }

  remove(key) {
    document.cookie = `${key}=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/`;
  }

  clear() {
    const cookies = document.cookie.split(';');
    for (let cookie of cookies) {
      const key = cookie.split('=')[0].trim();
      this.remove(key);
    }
  }
}

// storage/index.js - ç»Ÿä¸€å¯¼å‡º
function createStorage(type = 'local') {
  switch (type) {
    case 'local':
      return new LocalStorageAdapter();
    case 'session':
      return new SessionStorageAdapter();
    case 'memory':
      return new MemoryStorageAdapter();
    case 'cookie':
      return new CookieStorageAdapter();
    default:
      return new LocalStorageAdapter();
  }
}

export default createStorage;
```

```javascript
// ä½¿ç”¨å­˜å‚¨é€‚é…å™¨
import createStorage from './storage';

const storage = createStorage('local'); // å¯ä»¥è½»æ¾åˆ‡æ¢ä¸º 'session', 'memory', 'cookie'

function App() {
  const [user, setUser] = React.useState(null);

  React.useEffect(() => {
    // ä»å­˜å‚¨åŠ è½½ç”¨æˆ·
    const savedUser = storage.get('user');
    if (savedUser) {
      setUser(savedUser);
    }
  }, []);

  const handleLogin = (userData) => {
    setUser(userData);
    storage.set('user', userData); // ä¿å­˜åˆ°å­˜å‚¨
  };

  const handleLogout = () => {
    setUser(null);
    storage.remove('user'); // ä»å­˜å‚¨åˆ é™¤
  };

  return (
    <div>
      {user ? (
        <div>
          <p>æ¬¢è¿, {user.name}</p>
          <button onClick={handleLogout}>é€€å‡º</button>
        </div>
      ) : (
        <button onClick={() => handleLogin({ name: 'John' })}>ç™»å½•</button>
      )}
    </div>
  );
}
```

#### åœºæ™¯2ï¼šæ—¥æœŸåº“é€‚é…å™¨ï¼ˆå…¼å®¹ Moment.jsã€Day.jsã€date-fnsï¼‰

```javascript
// utils/dateAdapter.js
class DateAdapter {
  format(date, formatStr) {
    throw new Error('Subclass must implement format method');
  }

  parse(dateStr, formatStr) {
    throw new Error('Subclass must implement parse method');
  }

  add(date, amount, unit) {
    throw new Error('Subclass must implement add method');
  }

  diff(date1, date2, unit) {
    throw new Error('Subclass must implement diff method');
  }

  isBefore(date1, date2) {
    throw new Error('Subclass must implement isBefore method');
  }

  isAfter(date1, date2) {
    throw new Error('Subclass must implement isAfter method');
  }
}

// utils/MomentAdapter.js
import moment from 'moment';

class MomentAdapter extends DateAdapter {
  format(date, formatStr = 'YYYY-MM-DD') {
    return moment(date).format(formatStr);
  }

  parse(dateStr, formatStr = 'YYYY-MM-DD') {
    return moment(dateStr, formatStr).toDate();
  }

  add(date, amount, unit) {
    return moment(date).add(amount, unit).toDate();
  }

  diff(date1, date2, unit = 'days') {
    return moment(date1).diff(moment(date2), unit);
  }

  isBefore(date1, date2) {
    return moment(date1).isBefore(moment(date2));
  }

  isAfter(date1, date2) {
    return moment(date1).isAfter(moment(date2));
  }
}

// utils/DayJsAdapter.js
import dayjs from 'dayjs';

class DayJsAdapter extends DateAdapter {
  format(date, formatStr = 'YYYY-MM-DD') {
    return dayjs(date).format(formatStr);
  }

  parse(dateStr, formatStr = 'YYYY-MM-DD') {
    return dayjs(dateStr, formatStr).toDate();
  }

  add(date, amount, unit) {
    return dayjs(date).add(amount, unit).toDate();
  }

  diff(date1, date2, unit = 'day') {
    return dayjs(date1).diff(dayjs(date2), unit);
  }

  isBefore(date1, date2) {
    return dayjs(date1).isBefore(dayjs(date2));
  }

  isAfter(date1, date2) {
    return dayjs(date1).isAfter(dayjs(date2));
  }
}

// utils/NativeDateAdapter.js - ä½¿ç”¨åŸç”Ÿ Date å¯¹è±¡
class NativeDateAdapter extends DateAdapter {
  format(date, formatStr = 'YYYY-MM-DD') {
    const d = new Date(date);
    const year = d.getFullYear();
    const month = String(d.getMonth() + 1).padStart(2, '0');
    const day = String(d.getDate()).padStart(2, '0');

    return formatStr
      .replace('YYYY', year)
      .replace('MM', month)
      .replace('DD', day);
  }

  parse(dateStr) {
    return new Date(dateStr);
  }

  add(date, amount, unit) {
    const d = new Date(date);
    if (unit === 'days') {
      d.setDate(d.getDate() + amount);
    } else if (unit === 'months') {
      d.setMonth(d.getMonth() + amount);
    } else if (unit === 'years') {
      d.setFullYear(d.getFullYear() + amount);
    }
    return d;
  }

  diff(date1, date2, unit = 'days') {
    const diffMs = new Date(date1) - new Date(date2);
    if (unit === 'days') {
      return Math.floor(diffMs / (1000 * 60 * 60 * 24));
    }
    return diffMs;
  }

  isBefore(date1, date2) {
    return new Date(date1) < new Date(date2);
  }

  isAfter(date1, date2) {
    return new Date(date1) > new Date(date2);
  }
}

// å¯¼å‡º
export { DateAdapter, MomentAdapter, DayJsAdapter, NativeDateAdapter };
```

```javascript
// ä½¿ç”¨æ—¥æœŸé€‚é…å™¨
import { DayJsAdapter } from './utils/dateAdapter';

const dateUtil = new DayJsAdapter(); // å¯åˆ‡æ¢ä¸º MomentAdapter æˆ– NativeDateAdapter

function DateRangePicker() {
  const [startDate, setStartDate] = React.useState(new Date());
  const [endDate, setEndDate] = React.useState(
    dateUtil.add(new Date(), 7, 'days') // 7 å¤©å
  );

  const daysDiff = dateUtil.diff(endDate, startDate, 'days');

  return (
    <div>
      <p>å¼€å§‹æ—¥æœŸ: {dateUtil.format(startDate)}</p>
      <p>ç»“æŸæ—¥æœŸ: {dateUtil.format(endDate)}</p>
      <p>ç›¸å·®å¤©æ•°: {daysDiff} å¤©</p>
    </div>
  );
}
```

#### åœºæ™¯3ï¼šAPI æ•°æ®é€‚é…å™¨ï¼ˆåç«¯æ•°æ®æ ¼å¼è½¬æ¢ï¼‰

```javascript
// adapters/userAdapter.js - ç”¨æˆ·æ•°æ®é€‚é…å™¨
class UserAdapter {
  // å°†åç«¯æ•°æ®è½¬æ¢ä¸ºå‰ç«¯æ ¼å¼
  static toClient(serverUser) {
    return {
      id: serverUser.user_id,
      name: serverUser.user_name,
      email: serverUser.email_address,
      avatar: serverUser.avatar_url,
      createdAt: new Date(serverUser.created_at),
      isActive: serverUser.status === 1,
      role: this._mapRole(serverUser.role_id),
    };
  }

  // å°†å‰ç«¯æ•°æ®è½¬æ¢ä¸ºåç«¯æ ¼å¼
  static toServer(clientUser) {
    return {
      user_id: clientUser.id,
      user_name: clientUser.name,
      email_address: clientUser.email,
      avatar_url: clientUser.avatar,
      created_at: clientUser.createdAt?.toISOString(),
      status: clientUser.isActive ? 1 : 0,
      role_id: this._mapRoleToId(clientUser.role),
    };
  }

  static toClientList(serverUsers) {
    return serverUsers.map(user => this.toClient(user));
  }

  static _mapRole(roleId) {
    const roleMap = {
      1: 'admin',
      2: 'user',
      3: 'guest',
    };
    return roleMap[roleId] || 'guest';
  }

  static _mapRoleToId(role) {
    const roleMap = {
      admin: 1,
      user: 2,
      guest: 3,
    };
    return roleMap[role] || 3;
  }
}

export default UserAdapter;
```

```javascript
// ä½¿ç”¨æ•°æ®é€‚é…å™¨
import UserAdapter from './adapters/userAdapter';

function UserList() {
  const [users, setUsers] = React.useState([]);

  React.useEffect(() => {
    fetch('/api/users')
      .then(res => res.json())
      .then(data => {
        // åç«¯è¿”å›çš„æ•°æ®æ ¼å¼
        // { user_id: 1, user_name: 'John', email_address: 'john@example.com', ... }

        // ä½¿ç”¨é€‚é…å™¨è½¬æ¢ä¸ºå‰ç«¯æ ¼å¼
        const clientUsers = UserAdapter.toClientList(data);
        setUsers(clientUsers);

        // ç°åœ¨å¯ä»¥ä½¿ç”¨å‰ç«¯æ ¼å¼
        // { id: 1, name: 'John', email: 'john@example.com', ... }
      });
  }, []);

  const handleUpdateUser = (user) => {
    // å°†å‰ç«¯æ ¼å¼è½¬æ¢ä¸ºåç«¯æ ¼å¼
    const serverUser = UserAdapter.toServer(user);

    fetch(`/api/users/${user.id}`, {
      method: 'PUT',
      body: JSON.stringify(serverUser),
    });
  };

  return (
    <ul>
      {users.map(user => (
        <li key={user.id}>
          {user.name} ({user.email}) - {user.role}
        </li>
      ))}
    </ul>
  );
}
```

---

### ğŸ¨ åœ¨ä¸»æµæ¡†æ¶ä¸­çš„åº”ç”¨

#### Axios é€‚é…å™¨ç³»ç»Ÿ

```javascript
// Axios å†…éƒ¨ä½¿ç”¨é€‚é…å™¨æ¨¡å¼æ”¯æŒæµè§ˆå™¨å’Œ Node.js
import axios from 'axios';

// Axios è‡ªåŠ¨é€‰æ‹©é€‚é…å™¨
// æµè§ˆå™¨ç¯å¢ƒä½¿ç”¨ XMLHttpRequest
// Node.js ç¯å¢ƒä½¿ç”¨ http/https æ¨¡å—

// ä¹Ÿå¯ä»¥è‡ªå®šä¹‰é€‚é…å™¨
const customAdapter = (config) => {
  return new Promise((resolve, reject) => {
    // è‡ªå®šä¹‰è¯·æ±‚é€»è¾‘
    // ...
    resolve({
      data: {},
      status: 200,
      headers: {},
      config,
    });
  });
};

const instance = axios.create({
  adapter: customAdapter,
});
```

#### React äº‹ä»¶ç³»ç»Ÿé€‚é…å™¨

```javascript
// React å†…éƒ¨ä½¿ç”¨é€‚é…å™¨ç»Ÿä¸€ä¸åŒæµè§ˆå™¨çš„äº‹ä»¶
// å¼€å‘è€…ä½¿ç”¨ç»Ÿä¸€çš„æ¥å£
function Button() {
  const handleClick = (e) => {
    // e æ˜¯ React çš„åˆæˆäº‹ä»¶ï¼Œç»Ÿä¸€äº†æ‰€æœ‰æµè§ˆå™¨çš„å·®å¼‚
    console.log(e.target);
  };

  return <button onClick={handleClick}>Click</button>;
}
```

---

### âš–ï¸ ä¼˜ç¼ºç‚¹åˆ†æ

#### âœ… ä¼˜ç‚¹

1. **è§£è€¦**ï¼šå®¢æˆ·ç«¯ä¸å…·ä½“å®ç°è§£è€¦
2. **æ˜“äºåˆ‡æ¢**ï¼šå¯ä»¥è½»æ¾åˆ‡æ¢ä¸åŒçš„å®ç°
3. **å¤ç”¨æ€§**ï¼šé€‚é…å™¨å¯ä»¥å¤ç”¨äºå¤šä¸ªåœºæ™¯
4. **ç¬¦åˆå¼€é—­åŸåˆ™**ï¼šæ·»åŠ æ–°é€‚é…å™¨ä¸å½±å“ç°æœ‰ä»£ç 

#### âŒ ç¼ºç‚¹

1. **å¢åŠ å¤æ‚åº¦**ï¼šå¼•å…¥é¢å¤–çš„é€‚é…å™¨å±‚
2. **æ€§èƒ½å¼€é”€**ï¼šæ•°æ®è½¬æ¢æœ‰ä¸€å®šå¼€é”€
3. **è¿‡åº¦ä½¿ç”¨**ï¼šç®€å•åœºæ™¯ä¸éœ€è¦é€‚é…å™¨

---

### ğŸ“‹ ä½•æ—¶ä½¿ç”¨é€‚é…å™¨æ¨¡å¼

#### âœ… é€‚åˆä½¿ç”¨çš„åœºæ™¯

- ç¬¬ä¸‰æ–¹åº“è¿ç§»ï¼ˆAxios â†’ Fetchï¼‰
- å¤šç§å­˜å‚¨æ–¹æ¡ˆï¼ˆlocalStorageã€sessionStorageã€Cookieï¼‰
- API æ•°æ®æ ¼å¼è½¬æ¢ï¼ˆåç«¯ snake_case â†’ å‰ç«¯ camelCaseï¼‰
- è·¨å¹³å°é€‚é…ï¼ˆWebã€React Nativeã€å°ç¨‹åºï¼‰
- æ—§ä»£ç é‡æ„ä½†ä¸æƒ³ä¿®æ”¹æ¥å£

#### âŒ ä¸é€‚åˆä½¿ç”¨çš„åœºæ™¯

- æ¥å£å·²ç»ç»Ÿä¸€
- åªæœ‰ä¸€ç§å®ç°
- æ•°æ®æ ¼å¼ç®€å•ï¼Œä¸éœ€è¦è½¬æ¢

---

## å¤–è§‚æ¨¡å¼

### ğŸ’¡ æ¨¡å¼å®šä¹‰
å¤–è§‚æ¨¡å¼ï¼ˆFacade Patternï¼‰ä¸ºå¤æ‚çš„å­ç³»ç»Ÿæä¾›ä¸€ä¸ªç®€å•çš„ç»Ÿä¸€æ¥å£ï¼Œéšè—å­ç³»ç»Ÿçš„å¤æ‚æ€§ï¼Œä½¿å­ç³»ç»Ÿæ›´å®¹æ˜“ä½¿ç”¨ã€‚

### ğŸ¤” ä¸ºä»€ä¹ˆéœ€è¦å¤–è§‚æ¨¡å¼ï¼Ÿ

#### é—®é¢˜åœºæ™¯ï¼šå¤æ‚çš„ API è°ƒç”¨ã€å¤šä¸ªæ­¥éª¤çš„æ“ä½œ

å‡è®¾ä½ çš„åº”ç”¨éœ€è¦åˆå§‹åŒ–å¾ˆå¤šæœåŠ¡ï¼š

#### âŒ ä¸ä½¿ç”¨å¤–è§‚æ¨¡å¼çš„ç—›ç‚¹

```javascript
// App.jsx - åˆå§‹åŒ–é€»è¾‘æ•£è½å„å¤„
import { initAuth } from './services/auth';
import { initAnalytics } from './services/analytics';
import { initNotifications } from './services/notifications';
import { initDatabase } from './services/database';
import { initLogger } from './services/logger';
import { loadUserPreferences } from './services/preferences';
import { connectWebSocket } from './services/websocket';

function App() {
  const [isInitialized, setIsInitialized] = React.useState(false);

  React.useEffect(() => {
    const initialize = async () => {
      try {
        // åˆå§‹åŒ–æ—¥å¿—
        await initLogger({
          level: 'info',
          endpoint: '/api/logs',
        });

        // åˆå§‹åŒ–æ•°æ®åº“
        await initDatabase({
          name: 'myapp',
          version: 1,
        });

        // åˆå§‹åŒ–è®¤è¯
        const authResult = await initAuth({
          clientId: 'xxx',
          redirectUri: window.location.origin,
        });

        if (!authResult.isAuthenticated) {
          throw new Error('Authentication failed');
        }

        // åˆå§‹åŒ–åˆ†æ
        await initAnalytics({
          trackingId: 'GA-XXXXX',
          userId: authResult.user.id,
        });

        // åŠ è½½ç”¨æˆ·åå¥½
        const preferences = await loadUserPreferences(authResult.user.id);
        applyPreferences(preferences);

        // åˆå§‹åŒ–é€šçŸ¥
        await initNotifications({
          permission: true,
          userId: authResult.user.id,
        });

        // è¿æ¥ WebSocket
        await connectWebSocket({
          url: 'wss://api.example.com',
          token: authResult.token,
        });

        setIsInitialized(true);
      } catch (error) {
        console.error('åˆå§‹åŒ–å¤±è´¥:', error);
        // æ¸…ç†å·²åˆå§‹åŒ–çš„æœåŠ¡
        // ...
      }
    };

    initialize();
  }, []);

  if (!isInitialized) {
    return <div>åˆå§‹åŒ–ä¸­...</div>;
  }

  return <div>åº”ç”¨å†…å®¹</div>;
}
```

**é—®é¢˜**ï¼š
- åˆå§‹åŒ–é€»è¾‘å¤æ‚ï¼Œéš¾ä»¥ç»´æŠ¤
- é”™è¯¯å¤„ç†å›°éš¾
- æ¯ä¸ªæ–°é¡¹ç›®éƒ½è¦å¤åˆ¶ç²˜è´´è¿™äº›ä»£ç 
- è°ƒç”¨é¡ºåºå®¹æ˜“å‡ºé”™

---

#### âœ… ä½¿ç”¨å¤–è§‚æ¨¡å¼è§£å†³

```javascript
// services/AppFacade.js - åº”ç”¨å¤–è§‚
class AppFacade {
  constructor(config = {}) {
    this.config = {
      logLevel: 'info',
      analyticsId: null,
      authConfig: {},
      ...config,
    };

    this.services = {
      logger: null,
      database: null,
      auth: null,
      analytics: null,
      notifications: null,
      websocket: null,
    };

    this.isInitialized = false;
  }

  // ç»Ÿä¸€åˆå§‹åŒ–å…¥å£
  async initialize() {
    if (this.isInitialized) {
      console.warn('App already initialized');
      return;
    }

    try {
      // æŒ‰é¡ºåºåˆå§‹åŒ–æ‰€æœ‰æœåŠ¡
      await this._initLogger();
      await this._initDatabase();
      const user = await this._initAuth();
      await this._initAnalytics(user);
      await this._loadPreferences(user);
      await this._initNotifications(user);
      await this._connectWebSocket(user);

      this.isInitialized = true;
      console.log('App initialized successfully');
    } catch (error) {
      console.error('App initialization failed:', error);
      await this.cleanup();
      throw error;
    }
  }

  // å†…éƒ¨åˆå§‹åŒ–æ–¹æ³•
  async _initLogger() {
    const { initLogger } = await import('./logger');
    this.services.logger = await initLogger({
      level: this.config.logLevel,
      endpoint: '/api/logs',
    });
  }

  async _initDatabase() {
    const { initDatabase } = await import('./database');
    this.services.database = await initDatabase({
      name: 'myapp',
      version: 1,
    });
  }

  async _initAuth() {
    const { initAuth } = await import('./auth');
    this.services.auth = await initAuth(this.config.authConfig);

    if (!this.services.auth.isAuthenticated) {
      throw new Error('Authentication failed');
    }

    return this.services.auth.user;
  }

  async _initAnalytics(user) {
    if (!this.config.analyticsId) return;

    const { initAnalytics } = await import('./analytics');
    this.services.analytics = await initAnalytics({
      trackingId: this.config.analyticsId,
      userId: user.id,
    });
  }

  async _loadPreferences(user) {
    const { loadUserPreferences, applyPreferences } = await import('./preferences');
    const preferences = await loadUserPreferences(user.id);
    applyPreferences(preferences);
  }

  async _initNotifications(user) {
    const { initNotifications } = await import('./notifications');
    this.services.notifications = await initNotifications({
      permission: true,
      userId: user.id,
    });
  }

  async _connectWebSocket(user) {
    const { connectWebSocket } = await import('./websocket');
    this.services.websocket = await connectWebSocket({
      url: 'wss://api.example.com',
      token: this.services.auth.token,
    });
  }

  // ç»Ÿä¸€æ¸…ç†
  async cleanup() {
    console.log('Cleaning up services...');

    if (this.services.websocket) {
      this.services.websocket.disconnect();
    }

    if (this.services.notifications) {
      this.services.notifications.disable();
    }

    // æ¸…ç†å…¶ä»–æœåŠ¡...

    this.isInitialized = false;
  }

  // ä¾¿æ·æ–¹æ³•
  getService(name) {
    return this.services[name];
  }

  isReady() {
    return this.isInitialized;
  }
}

export default AppFacade;
```

```javascript
// App.jsx - ç®€æ´çš„ä½¿ç”¨æ–¹å¼
import AppFacade from './services/AppFacade';

function App() {
  const [isReady, setIsReady] = React.useState(false);
  const appFacadeRef = React.useRef(null);

  React.useEffect(() => {
    const appFacade = new AppFacade({
      logLevel: 'info',
      analyticsId: 'GA-XXXXX',
      authConfig: {
        clientId: 'xxx',
        redirectUri: window.location.origin,
      },
    });

    appFacadeRef.current = appFacade;

    // ä¸€è¡Œä»£ç å®Œæˆæ‰€æœ‰åˆå§‹åŒ–ï¼
    appFacade.initialize()
      .then(() => setIsReady(true))
      .catch(error => console.error('åˆå§‹åŒ–å¤±è´¥:', error));

    // æ¸…ç†
    return () => {
      appFacade.cleanup();
    };
  }, []);

  if (!isReady) {
    return <div>åˆå§‹åŒ–ä¸­...</div>;
  }

  return <div>åº”ç”¨å†…å®¹</div>;
}
```

**æ•ˆæœ**ï¼š
- âœ… ç®€åŒ–è°ƒç”¨ï¼šä¸€è¡Œä»£ç å®Œæˆå¤æ‚åˆå§‹åŒ–
- âœ… æ˜“äºç»´æŠ¤ï¼šæ‰€æœ‰åˆå§‹åŒ–é€»è¾‘é›†ä¸­ç®¡ç†
- âœ… é”™è¯¯å¤„ç†ï¼šç»Ÿä¸€çš„é”™è¯¯å¤„ç†å’Œæ¸…ç†
- âœ… å¯å¤ç”¨ï¼šå¯ä»¥åœ¨å¤šä¸ªé¡¹ç›®ä¸­å¤ç”¨

---

### ğŸ—ï¸ çœŸå®ä¸šåŠ¡åœºæ™¯

#### åœºæ™¯1ï¼šæ–‡ä»¶ä¸Šä¼ å¤–è§‚

```javascript
// services/UploadFacade.js - æ–‡ä»¶ä¸Šä¼ å¤–è§‚
class UploadFacade {
  constructor(config = {}) {
    this.config = {
      maxSize: 10 * 1024 * 1024, // 10MB
      allowedTypes: ['image/jpeg', 'image/png', 'application/pdf'],
      endpoint: '/api/upload',
      chunkSize: 1024 * 1024, // 1MB chunks
      ...config,
    };
  }

  // ç®€å•ä¸Šä¼ æ¥å£
  async upload(file, options = {}) {
    try {
      // 1. éªŒè¯æ–‡ä»¶
      this._validateFile(file);

      // 2. å‹ç¼©å›¾ç‰‡ï¼ˆå¦‚æœæ˜¯å›¾ç‰‡ï¼‰
      const processedFile = await this._processFile(file);

      // 3. ç”Ÿæˆç¼©ç•¥å›¾ï¼ˆå¦‚æœæ˜¯å›¾ç‰‡ï¼‰
      const thumbnail = await this._generateThumbnail(processedFile);

      // 4. ä¸Šä¼ æ–‡ä»¶
      const uploadResult = await this._uploadFile(processedFile, options);

      // 5. ä¸Šä¼ ç¼©ç•¥å›¾
      if (thumbnail) {
        await this._uploadThumbnail(thumbnail, uploadResult.id);
      }

      // 6. è¿”å›ç»“æœ
      return {
        id: uploadResult.id,
        url: uploadResult.url,
        thumbnailUrl: uploadResult.thumbnailUrl,
        size: processedFile.size,
        type: processedFile.type,
      };
    } catch (error) {
      console.error('ä¸Šä¼ å¤±è´¥:', error);
      throw error;
    }
  }

  // åˆ†ç‰‡ä¸Šä¼ 
  async uploadLargeFile(file, onProgress) {
    this._validateFile(file);

    const totalChunks = Math.ceil(file.size / this.config.chunkSize);
    let uploadedChunks = 0;

    // åˆ›å»ºä¸Šä¼ ä»»åŠ¡
    const uploadId = await this._createUploadTask(file);

    // åˆ†ç‰‡ä¸Šä¼ 
    for (let i = 0; i < totalChunks; i++) {
      const start = i * this.config.chunkSize;
      const end = Math.min(start + this.config.chunkSize, file.size);
      const chunk = file.slice(start, end);

      await this._uploadChunk(uploadId, i, chunk);

      uploadedChunks++;
      onProgress?.((uploadedChunks / totalChunks) * 100);
    }

    // åˆå¹¶åˆ†ç‰‡
    const result = await this._mergeChunks(uploadId);
    return result;
  }

  // æ‰¹é‡ä¸Šä¼ 
  async uploadMultiple(files, onProgress) {
    const results = [];
    let completed = 0;

    for (const file of files) {
      try {
        const result = await this.upload(file);
        results.push({ success: true, file, result });
      } catch (error) {
        results.push({ success: false, file, error });
      }

      completed++;
      onProgress?.((completed / files.length) * 100);
    }

    return results;
  }

  // å†…éƒ¨æ–¹æ³•
  _validateFile(file) {
    if (file.size > this.config.maxSize) {
      throw new Error(`æ–‡ä»¶å¤§å°è¶…è¿‡é™åˆ¶ (${this.config.maxSize / 1024 / 1024}MB)`);
    }

    if (!this.config.allowedTypes.includes(file.type)) {
      throw new Error(`ä¸æ”¯æŒçš„æ–‡ä»¶ç±»å‹: ${file.type}`);
    }
  }

  async _processFile(file) {
    if (!file.type.startsWith('image/')) {
      return file;
    }

    // å‹ç¼©å›¾ç‰‡
    return await this._compressImage(file);
  }

  async _compressImage(file) {
    return new Promise((resolve) => {
      const reader = new FileReader();
      reader.onload = (e) => {
        const img = new Image();
        img.onload = () => {
          const canvas = document.createElement('canvas');
          const ctx = canvas.getContext('2d');

          // è®¡ç®—å‹ç¼©åçš„å°ºå¯¸
          let width = img.width;
          let height = img.height;
          const maxDimension = 1920;

          if (width > maxDimension || height > maxDimension) {
            if (width > height) {
              height = (height / width) * maxDimension;
              width = maxDimension;
            } else {
              width = (width / height) * maxDimension;
              height = maxDimension;
            }
          }

          canvas.width = width;
          canvas.height = height;
          ctx.drawImage(img, 0, 0, width, height);

          canvas.toBlob((blob) => {
            resolve(new File([blob], file.name, { type: file.type }));
          }, file.type, 0.9);
        };
        img.src = e.target.result;
      };
      reader.readAsDataURL(file);
    });
  }

  async _generateThumbnail(file) {
    if (!file.type.startsWith('image/')) {
      return null;
    }

    // ç”Ÿæˆç¼©ç•¥å›¾é€»è¾‘
    return null; // ç®€åŒ–å®ç°
  }

  async _uploadFile(file, options) {
    const formData = new FormData();
    formData.append('file', file);

    const response = await fetch(this.config.endpoint, {
      method: 'POST',
      body: formData,
      headers: options.headers || {},
    });

    return await response.json();
  }

  async _uploadThumbnail(thumbnail, fileId) {
    // ä¸Šä¼ ç¼©ç•¥å›¾
  }

  async _createUploadTask(file) {
    // åˆ›å»ºåˆ†ç‰‡ä¸Šä¼ ä»»åŠ¡
    return 'upload-id-123';
  }

  async _uploadChunk(uploadId, chunkIndex, chunk) {
    // ä¸Šä¼ å•ä¸ªåˆ†ç‰‡
  }

  async _mergeChunks(uploadId) {
    // åˆå¹¶æ‰€æœ‰åˆ†ç‰‡
  }
}

export default UploadFacade;
```

```javascript
// ä½¿ç”¨ä¸Šä¼ å¤–è§‚
import UploadFacade from './services/UploadFacade';

function FileUploader() {
  const [uploading, setUploading] = React.useState(false);
  const [progress, setProgress] = React.useState(0);

  const uploadFacade = new UploadFacade({
    maxSize: 20 * 1024 * 1024, // 20MB
    allowedTypes: ['image/jpeg', 'image/png'],
  });

  const handleFileSelect = async (e) => {
    const file = e.target.files[0];
    if (!file) return;

    setUploading(true);

    try {
      // ç®€å•è°ƒç”¨ï¼Œå†…éƒ¨è‡ªåŠ¨å¤„ç†å‹ç¼©ã€ç¼©ç•¥å›¾ã€ä¸Šä¼ ç­‰
      const result = await uploadFacade.upload(file);
      console.log('ä¸Šä¼ æˆåŠŸ:', result);
    } catch (error) {
      console.error('ä¸Šä¼ å¤±è´¥:', error);
    } finally {
      setUploading(false);
    }
  };

  const handleLargeFileSelect = async (e) => {
    const file = e.target.files[0];
    if (!file) return;

    setUploading(true);

    try {
      // å¤§æ–‡ä»¶è‡ªåŠ¨åˆ†ç‰‡ä¸Šä¼ 
      const result = await uploadFacade.uploadLargeFile(file, setProgress);
      console.log('ä¸Šä¼ æˆåŠŸ:', result);
    } catch (error) {
      console.error('ä¸Šä¼ å¤±è´¥:', error);
    } finally {
      setUploading(false);
      setProgress(0);
    }
  };

  return (
    <div>
      <input type="file" onChange={handleFileSelect} disabled={uploading} />
      <input type="file" onChange={handleLargeFileSelect} disabled={uploading} />
      {uploading && <div>ä¸Šä¼ ä¸­... {progress.toFixed(0)}%</div>}
    </div>
  );
}
```

#### åœºæ™¯2ï¼šæ”¯ä»˜å¤–è§‚

```javascript
// services/PaymentFacade.js - æ”¯ä»˜å¤–è§‚
class PaymentFacade {
  constructor() {
    this.providers = {
      alipay: null,
      wechat: null,
      stripe: null,
    };
  }

  // ç»Ÿä¸€æ”¯ä»˜æ¥å£
  async pay(provider, amount, options = {}) {
    try {
      // 1. éªŒè¯é‡‘é¢
      this._validateAmount(amount);

      // 2. åˆ›å»ºè®¢å•
      const order = await this._createOrder(amount, options);

      // 3. è°ƒç”¨æ”¯ä»˜æä¾›å•†
      let paymentResult;
      switch (provider) {
        case 'alipay':
          paymentResult = await this._payWithAlipay(order);
          break;
        case 'wechat':
          paymentResult = await this._payWithWechat(order);
          break;
        case 'stripe':
          paymentResult = await this._payWithStripe(order);
          break;
        default:
          throw new Error(`ä¸æ”¯æŒçš„æ”¯ä»˜æ–¹å¼: ${provider}`);
      }

      // 4. è®°å½•æ”¯ä»˜æ—¥å¿—
      await this._logPayment(order, paymentResult);

      // 5. å‘é€é€šçŸ¥
      await this._sendNotification(order, paymentResult);

      return {
        success: true,
        orderId: order.id,
        transactionId: paymentResult.transactionId,
      };
    } catch (error) {
      console.error('æ”¯ä»˜å¤±è´¥:', error);
      throw error;
    }
  }

  // æŸ¥è¯¢æ”¯ä»˜çŠ¶æ€
  async queryStatus(orderId) {
    const order = await this._getOrder(orderId);
    return {
      orderId: order.id,
      status: order.status,
      amount: order.amount,
      createdAt: order.createdAt,
    };
  }

  // é€€æ¬¾
  async refund(orderId, amount) {
    const order = await this._getOrder(orderId);

    // è°ƒç”¨å¯¹åº”æ”¯ä»˜æä¾›å•†çš„é€€æ¬¾æ¥å£
    let refundResult;
    switch (order.provider) {
      case 'alipay':
        refundResult = await this._refundAlipay(order, amount);
        break;
      case 'wechat':
        refundResult = await this._refundWechat(order, amount);
        break;
      case 'stripe':
        refundResult = await this._refundStripe(order, amount);
        break;
    }

    await this._logRefund(order, refundResult);
    return refundResult;
  }

  // å†…éƒ¨æ–¹æ³•
  _validateAmount(amount) {
    if (amount <= 0) {
      throw new Error('é‡‘é¢å¿…é¡»å¤§äº0');
    }
  }

  async _createOrder(amount, options) {
    return {
      id: 'ORDER-' + Date.now(),
      amount,
      status: 'pending',
      createdAt: new Date(),
      ...options,
    };
  }

  async _payWithAlipay(order) {
    // è°ƒç”¨æ”¯ä»˜å® SDK
    return { transactionId: 'ALIPAY-' + Date.now() };
  }

  async _payWithWechat(order) {
    // è°ƒç”¨å¾®ä¿¡æ”¯ä»˜ SDK
    return { transactionId: 'WECHAT-' + Date.now() };
  }

  async _payWithStripe(order) {
    // è°ƒç”¨ Stripe SDK
    return { transactionId: 'STRIPE-' + Date.now() };
  }

  async _logPayment(order, result) {
    console.log('æ”¯ä»˜æ—¥å¿—:', order, result);
  }

  async _sendNotification(order, result) {
    console.log('å‘é€é€šçŸ¥:', order, result);
  }

  async _getOrder(orderId) {
    // è·å–è®¢å•ä¿¡æ¯
    return { id: orderId, provider: 'alipay' };
  }

  async _refundAlipay(order, amount) {
    // æ”¯ä»˜å®é€€æ¬¾
  }

  async _refundWechat(order, amount) {
    // å¾®ä¿¡é€€æ¬¾
  }

  async _refundStripe(order, amount) {
    // Stripe é€€æ¬¾
  }

  async _logRefund(order, result) {
    console.log('é€€æ¬¾æ—¥å¿—:', order, result);
  }
}

export default PaymentFacade;
```

```javascript
// ä½¿ç”¨æ”¯ä»˜å¤–è§‚
import PaymentFacade from './services/PaymentFacade';

function CheckoutPage() {
  const [paying, setPaying] = React.useState(false);
  const paymentFacade = new PaymentFacade();

  const handlePay = async (provider) => {
    setPaying(true);

    try {
      // ç®€å•è°ƒç”¨ï¼Œå†…éƒ¨è‡ªåŠ¨å¤„ç†è®¢å•åˆ›å»ºã€æ”¯ä»˜ã€æ—¥å¿—ã€é€šçŸ¥ç­‰
      const result = await paymentFacade.pay(provider, 99.99, {
        productId: 'PROD-123',
        userId: 'USER-456',
      });

      console.log('æ”¯ä»˜æˆåŠŸ:', result);
    } catch (error) {
      console.error('æ”¯ä»˜å¤±è´¥:', error);
    } finally {
      setPaying(false);
    }
  };

  return (
    <div>
      <button onClick={() => handlePay('alipay')} disabled={paying}>
        æ”¯ä»˜å®æ”¯ä»˜
      </button>
      <button onClick={() => handlePay('wechat')} disabled={paying}>
        å¾®ä¿¡æ”¯ä»˜
      </button>
      <button onClick={() => handlePay('stripe')} disabled={paying}>
        Stripe æ”¯ä»˜
      </button>
    </div>
  );
}
```

---

### ğŸ¨ åœ¨ä¸»æµæ¡†æ¶ä¸­çš„åº”ç”¨

#### jQuery - å¤–è§‚æ¨¡å¼çš„å…¸å‹åº”ç”¨

```javascript
// jQuery å°è£…äº†å¤æ‚çš„ DOM æ“ä½œ
$('#button').on('click', function() {
  $(this).addClass('active');
});

// ç­‰ä»·äºåŸç”Ÿ JavaScript
document.getElementById('button').addEventListener('click', function() {
  this.classList.add('active');
});
```

#### React Router - ç®€åŒ–è·¯ç”±é…ç½®

```javascript
// React Router æä¾›ç®€å•çš„è·¯ç”±é…ç½®æ¥å£
import { BrowserRouter, Route, Switch } from 'react-router-dom';

function App() {
  return (
    <BrowserRouter>
      <Switch>
        <Route path="/" exact component={Home} />
        <Route path="/about" component={About} />
      </Switch>
    </BrowserRouter>
  );
}

// å†…éƒ¨å¤„ç†äº†å¤æ‚çš„è·¯ç”±åŒ¹é…ã€å†å²è®°å½•ç®¡ç†ç­‰
```

---

### âš–ï¸ ä¼˜ç¼ºç‚¹åˆ†æ

#### âœ… ä¼˜ç‚¹

1. **ç®€åŒ–æ¥å£**ï¼šä¸ºå¤æ‚ç³»ç»Ÿæä¾›ç®€å•æ¥å£
2. **è§£è€¦**ï¼šå®¢æˆ·ç«¯ä¸å­ç³»ç»Ÿè§£è€¦
3. **æ˜“ç”¨æ€§**ï¼šé™ä½ä½¿ç”¨éš¾åº¦
4. **åˆ†å±‚**ï¼šå®šä¹‰ç³»ç»Ÿä¸­æ¯ä¸€å±‚çš„å…¥å£ç‚¹

#### âŒ ç¼ºç‚¹

1. **ä¸ç¬¦åˆå¼€é—­åŸåˆ™**ï¼šå¢åŠ æ–°çš„å­ç³»ç»Ÿå¯èƒ½éœ€è¦ä¿®æ”¹å¤–è§‚ç±»
2. **è¿‡åº¦ç®€åŒ–**ï¼šå¯èƒ½éšè—äº†ç”¨æˆ·éœ€è¦çš„ç»†èŠ‚
3. **å•ç‚¹æ•…éšœ**ï¼šå¤–è§‚ç±»å‡ºé—®é¢˜ä¼šå½±å“æ‰€æœ‰è°ƒç”¨

---

### ğŸ“‹ ä½•æ—¶ä½¿ç”¨å¤–è§‚æ¨¡å¼

#### âœ… é€‚åˆä½¿ç”¨çš„åœºæ™¯

- ä¸ºå¤æ‚ç³»ç»Ÿæä¾›ç®€å•æ¥å£
- éœ€è¦å°è£…å¤šä¸ªæ­¥éª¤çš„æ“ä½œ
- è§£è€¦å®¢æˆ·ç«¯å’Œå­ç³»ç»Ÿ
- åˆ†å±‚æ¶æ„çš„å…¥å£ç‚¹

#### âŒ ä¸é€‚åˆä½¿ç”¨çš„åœºæ™¯

- ç³»ç»Ÿæœ¬èº«å¾ˆç®€å•
- éœ€è¦æš´éœ²æ‰€æœ‰ç»†èŠ‚ç»™å®¢æˆ·ç«¯
- å­ç³»ç»Ÿç»å¸¸å˜åŒ–

---

## ğŸ“ æ€»ç»“

### ç»“æ„å‹æ¨¡å¼å¯¹æ¯”

| æ¨¡å¼ | æ ¸å¿ƒç›®çš„ | ä½¿ç”¨åœºæ™¯ | ä¼˜å…ˆçº§ |
|-----|---------|---------|-------|
| **è£…é¥°å™¨æ¨¡å¼** | åŠ¨æ€æ·»åŠ åŠŸèƒ½ | HOCã€ä¸­é—´ä»¶ã€æƒé™æ§åˆ¶ | â­â­â­â­â­ |
| **ä»£ç†æ¨¡å¼** | æ§åˆ¶å¯¹è±¡è®¿é—® | æ‡’åŠ è½½ã€ç¼“å­˜ã€æƒé™éªŒè¯ | â­â­â­â­â­ |
| **é€‚é…å™¨æ¨¡å¼** | æ¥å£è½¬æ¢ | ç¬¬ä¸‰æ–¹åº“è¿ç§»ã€æ•°æ®æ ¼å¼è½¬æ¢ | â­â­â­â­ |
| **å¤–è§‚æ¨¡å¼** | ç®€åŒ–æ¥å£ | å¤æ‚ç³»ç»Ÿå°è£…ã€å¤šæ­¥éª¤æ“ä½œ | â­â­â­â­ |

### å­¦ä¹ å»ºè®®

1. **è£…é¥°å™¨æ¨¡å¼**ï¼šReact HOC å’Œ Hooks éƒ½æ˜¯è£…é¥°å™¨æ€æƒ³ï¼Œé‡ç‚¹æŒæ¡
2. **ä»£ç†æ¨¡å¼**ï¼šç†è§£ ES6 Proxy å’Œ Vue 3 å“åº”å¼åŸç†
3. **é€‚é…å™¨æ¨¡å¼**ï¼šåœ¨é‡æ„å’Œè¿ç§»ä¸­éå¸¸æœ‰ç”¨
4. **å¤–è§‚æ¨¡å¼**ï¼šå­¦ä¼šå°è£…å¤æ‚é€»è¾‘ï¼Œæä¾›ç®€å• API

### å››ç§æ¨¡å¼çš„åŒºåˆ«

- **è£…é¥°å™¨**ï¼šä¸æ”¹å˜æ¥å£ï¼Œå¢å¼ºåŠŸèƒ½
- **ä»£ç†**ï¼šç›¸åŒæ¥å£ï¼Œæ§åˆ¶è®¿é—®
- **é€‚é…å™¨**ï¼šè½¬æ¢æ¥å£ï¼Œè§£å†³ä¸å…¼å®¹
- **å¤–è§‚**ï¼šæä¾›æ–°æ¥å£ï¼Œç®€åŒ–å¤æ‚ç³»ç»Ÿ

---

**ä¸‹ä¸€æ­¥**ï¼šç»§ç»­å­¦ä¹  [è¡Œä¸ºå‹æ¨¡å¼](./03-è¡Œä¸ºå‹æ¨¡å¼.md)ï¼Œå­¦ä¹ å¯¹è±¡é—´çš„äº¤äº’æ¨¡å¼ã€‚

ğŸ‰ æ­å–œå®Œæˆç»“æ„å‹æ¨¡å¼çš„å­¦ä¹ ï¼
